<!doctype html>
<html lang="tr" class="h-full">
 <head>

<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Ä°SG Denetim UygulamasÄ±</title>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#2563eb">
  <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3135/3135715.png">
  <link id="manifest-placeholder" rel="manifest">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- â­ GOOGLE SHEETS API SCRIPT'LERÄ° â­ -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client"></script>
  
  <script>
    // Manifest oluÅŸturucu 
    (function() {
      const manifest = {
        "name": "Ä°SG Denetim Sistemi",
        "short_name": "Ä°SG Form",
        "start_url": ".",
        "display": "standalone",
        "background_color": "#ffffff",
        "theme_color": "#2563eb",
        "icons": [{"src": "https://cdn-icons-png.flaticon.com/512/3135/3135715.png", "sizes": "512x512", "type": "image/png"}]
      };
      const blob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
      document.querySelector('#manifest-placeholder').setAttribute('href', URL.createObjectURL(blob));
    })();
  </script>

  <style>
    body {
      box-sizing: border-box;
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
    }
    
    .question-card {
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 16px;
      border: 1px solid #e5e7eb;
      background: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }
    .question-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    }
    @keyframes borderBlink {
      0%, 100% { box-shadow: 0 0 0 4px rgba(220, 38, 38, 0); }
      50% { box-shadow: 0 0 0 4px rgba(220, 38, 38, 1); }
    }
    .blink-border {
      animation: borderBlink 0.5s ease-in-out 4;
    }
    .question-card.answer-yes {
      border-color: #10b981;
      background: linear-gradient(to bottom, white, #f0fdf4);
    }
    .question-card.answer-no {
      border-color: #ef4444;
      background: linear-gradient(to bottom, white, #fef2f2);
    }
    .question-card.answer-na {
      border-color: #eab308;
      border-width: 1px;
      background: linear-gradient(to bottom, white, #fefce8);
    }
    .btn-answer {
      border: 2px solid;
      background: white;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      font-weight: 500;
      letter-spacing: -0.01em;
    }
    .btn-answer:hover {
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    .btn-yes { color: #059669; border-color: #10b981; }
    .btn-yes.selected { background: #10b981; color: white; border-color: #10b981; }
    .btn-no { color: #dc2626; border-color: #ef4444; }
    .btn-no.selected { background: #ef4444; color: white; border-color: #ef4444; }
    .btn-na { color: #eab308; border-color: #eab308; }
    .btn-na.selected { background: #eab308; color: white; border-color: #eab308; }
    
    .toast {
      position: fixed;
      top: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: #18181b;
      color: white;
      padding: 14px 28px;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      z-index: 1000;
      font-weight: 500;
      font-size: 14px;
      letter-spacing: -0.01em;
      animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateX(-50%) translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
    }
    
    .tab-button {
      position: relative;
      padding: 16px 24px;
      font-weight: 500;
      transition: all 0.2s;
      border-bottom: 2px solid transparent;
      color: #64748b;
      letter-spacing: -0.01em;
    }
    .tab-button:hover {
      color: #334155;
    }
    .tab-button.active {
      color: #18181b;
      border-bottom-color: #18181b;
    }
    
    .modern-input {
      transition: all 0.2s;
    }
    .modern-input:focus {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    
    .modern-btn {
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      letter-spacing: -0.01em;
    }
    .modern-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .modern-btn:active {
      transform: translateY(0);
    }
    
    .unanswered-warning {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      background: #dc2626;
      color: white;
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      text-align: center;
      animation: fadeInScale 0.3s ease-out;
      z-index: 100;
      box-shadow: 0 8px 24px rgba(220, 38, 38, 0.4);
      width: calc(100% - 32px);
      max-width: 400px;
    }
    
    @keyframes fadeInScale {
      from {
        opacity: 0;
        transform: translateX(-50%) scale(0.8);
      }
      to {
        opacity: 1;
        transform: translateX(-50%) scale(1);
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
 </head>
 <body class="h-full bg-gray-50">

  <!-- â­ GOOGLE SHEETS KONFÄ°GÃœRASYON VE API BAÅLATMA â­ -->
  <script>
    // Google Sheets KonfigÃ¼rasyonu
    const GOOGLE_SHEET_CONFIG = {
      CLIENT_ID: 'YOUR_CLIENT_ID.apps.googleusercontent.com',
      API_KEY: 'YOUR_API_KEY',
      SPREADSHEET_ID: 'YOUR_SPREADSHEET_ID'
    };

    // Google API BaÅŸlat
    function initializeGoogleAPI() {
      gapi.load('client:auth2', async () => {
        try {
          await gapi.client.init({
            apiKey: GOOGLE_SHEET_CONFIG.API_KEY,
            clientId: GOOGLE_SHEET_CONFIG.CLIENT_ID,
            scope: 'https://www.googleapis.com/auth/spreadsheets',
            discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4']
          });
          console.log('âœ“ Google API baÅŸlatÄ±ldÄ±');
          checkAndSignInSilently();
        } catch (error) {
          console.error('API baÅŸlatma hatasÄ±:', error);
        }
      });
    }

    // Sessiz GiriÅŸ Dene
    async function checkAndSignInSilently() {
      try {
        const auth2 = gapi.auth2.getAuthInstance();
        if (auth2 && !auth2.isSignedIn.get()) {
          await auth2.signIn();
          console.log('âœ“ Google hesabÄ±na otomatik olarak baÄŸlandÄ±');
        }
      } catch (error) {
        console.log('Sessiz giriÅŸ baÅŸarÄ±sÄ±z (ilk kez yÃ¼klenmiÅŸse normal)');
      }
    }

    // Google Sheets'e Veri GÃ¶nder

async function sendToGoogleSheets(audit) {
  try {
    // Google Apps Script Web App URL
    const APPS_SCRIPT_URL = 'AKfycbxQ5yw6CtLl8jPPFDjV16nSY4sYztJ53gDe1a8KSXNV6wmoEBp3KVl93ndLbSJDtO3Q';
    // â¬†ï¸ BURAYA KENDI DEPLOYMENT URL'Ä°NÄ°ZÄ° YAPTIÅTIRIN
    
    const compliantCount = Object.values(audit.answers || {}).filter(a => a.value === 'yes').length;
    const deficiencyCount = Object.values(audit.answers || {}).filter(a => a.value === 'no').length;
    const otherDefCount = (audit.other_deficiencies || []).length;
    
    const payload = {
      id: audit.id,
      audit_date: audit.audit_date,
      school_name: audit.school_name,
      school_code: audit.school_code,
      school_district: audit.school_district || '',
      manager_count: audit.manager_count || 0,
      teacher_count: audit.teacher_count || 0,
      total_personnel: audit.total_personnel || 0,
      total_students: audit.total_students || 0,
      compliant_count: compliantCount,
      deficiency_count: deficiencyCount,
      other_dof_count: otherDefCount,
      status: audit.status,
      created_at: new Date().toLocaleString('tr-TR')
    };
    
    const response = await fetch(APPS_SCRIPT_URL, {
      method: 'POST',
      payload: JSON.stringify(payload)
    });
   
    const result = await response.json();
    
    if (result.success) {
      console.log('âœ“ Google Sheets\'e baÅŸarÄ±yla gÃ¶nderildi');
      return true;
    } else {
      console.error('Google Sheets gÃ¶nderme hatasÄ±:', result.error);
      return false;
    }
  } catch (error) {
    console.error('Google Sheets gÃ¶nderme hatasÄ±:', error);
    console.log('Veri LocalStorage\'da kaydedildi');
    return false;
  }
}
 
  <!-- Ana Sayfa -->
  <div id="home-page" class="h-full overflow-auto"><!-- Sabit BaÅŸlÄ±k ve Sekmeler -->
   <div class="sticky top-0 z-20 bg-gray-50 pb-4">
    <div class="max-w-4xl mx-auto p-4 pb-0"><!-- BaÅŸlÄ±k -->
     <div class="text-center mb-4 pt-4">
      <div class="bg-white border border-blue-300 rounded-3xl shadow-sm p-6">
       <h1 class="text-3xl font-bold text-blue-900 mb-2 tracking-tight">Ä°Å SAÄLIÄI VE GÃœVENLÄ°ÄÄ°</h1>
       <p class="text-blue-900 font-medium">Ortam GÃ¶zetimi, Rehberlik ve Denetim UygulamasÄ±</p>
      </div>
     </div><!-- Sekmeler -->
     <div class="bg-white rounded-3xl shadow-sm border border-gray-200">
      <div class="flex border-b border-gray-100"><button id="tab-new" class="tab-button flex-1 active" onclick="switchTab('new')">
        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="#3b82f6" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg> Yeni </button> <button id="tab-data" class="tab-button flex-1" onclick="switchTab('data')">
        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="#10b981" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </svg> Veri </button> <button id="tab-info" class="tab-button flex-1" onclick="switchTab('info')">
        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="#8b5cf6" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg> Bilgi </button>
      </div>
     </div>
    </div>
   </div><!-- Ä°Ã§erik AlanÄ± -->
   <div class="max-w-4xl mx-auto px-4 pb-20"><!-- Yeni Denetim Ä°Ã§eriÄŸi -->
    <div id="content-new" class="p-8 bg-white rounded-3xl shadow-sm border border-gray-200">
     <div class="space-y-5">
      <div><label for="school-district" class="block text-sm font-medium text-gray-600 mb-2">Ä°lÃ§e *</label> <input type="text" id="school-district" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="Merkez">
      </div>
      <div><label for="school-name" class="block text-sm font-medium text-gray-600 mb-2">Okul AdÄ± *</label> <input type="text" id="school-name" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="Okul AdÄ±nÄ± Giriniz.">
      </div>
      <div><label for="school-code" class="block text-sm font-medium text-gray-600 mb-2">Okul Kodu *</label> <input type="text" id="school-code" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="123456">
      </div>
      <div><label for="audit-date" class="block text-sm font-medium text-gray-600 mb-2">Denetim Tarihi *</label> <input type="date" id="audit-date" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none">
      </div>
      <div><label for="school-address" class="block text-sm font-medium text-gray-600 mb-2">Adresi</label> <input type="text" id="school-address" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="Okul adresi">
      </div>
      <div><label for="school-scope" class="block text-sm font-medium text-gray-600 mb-2">Kapsam</label> <select id="school-scope" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none"> <option value="">SeÃ§iniz</option> <option value="Anaokulu">Anaokulu</option> <option value="Ä°lkokul">Ä°lkokul</option> <option value="Ortaokul">Ortaokul</option> <option value="Ä°lkokul/Ortaokul">Ä°lkokul/Ortaokul</option> <option value="Anadolu Lisesi">Anadolu Lisesi</option> <option value="Anadolu Ä°mam Hatip Lisesi">Anadolu Ä°mam Hatip Lisesi</option> <option value="Fen Lisesi">Fen Lisesi</option> <option value="BÄ°LSEM">BÄ°LSEM</option> <option value="MESEM">MESEM</option> <option value="Mesleki ve Teknik Anadolu Lisesi">Mesleki ve Teknik Anadolu Lisesi</option> <option value="YaygÄ±n EÄŸitim">YaygÄ±n EÄŸitim</option> </select>
      </div>
      <div><label for="school-hazard-class" class="block text-sm font-medium text-gray-600 mb-2">Tehlike SÄ±nÄ±fÄ±</label> <select id="school-hazard-class" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none"> <option value="">SeÃ§iniz</option> <option value="Az Tehlikeli">Az Tehlikeli</option> <option value="Tehlikeli">Tehlikeli</option> <option value="Ã‡ok Tehlikeli">Ã‡ok Tehlikeli</option> </select>
      </div>
      <div><label for="school-phone" class="block text-sm font-medium text-gray-600 mb-2">Telefon</label> <input type="tel" id="school-phone" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="0 (___) ___ __ __">
      </div>
      <div><label for="school-email" class="block text-sm font-medium text-gray-600 mb-2">E-Posta</label> <input type="email" id="school-email" class="modern-input w-full px-4 py-3.5 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" placeholder="okul@example.com">
      </div><!-- Ã–nceki Denetim UyarÄ±sÄ± -->
      <div id="previous-audit-warning" class="hidden bg-orange-50 border border-orange-200 rounded-2xl p-5">
       <div class="flex items-start gap-3">
        <div class="text-xl">
         âš ï¸
        </div>
        <div class="flex-1">
         <h3 class="font-semibold text-orange-800 mb-2">Ã–nceki Denetimde Eksiklik Bulundu</h3>
         <p class="text-sm text-orange-700 mb-3">Bu okul iÃ§in daha Ã¶nce yapÄ±lan denetimde tespit edilen ve henÃ¼z giderilmemiÅŸ eksiklikler bulunmaktadÄ±r.</p>
         <div id="previous-deficiencies-list" class="space-y-2"></div>
         <p class="text-xs text-orange-600 mt-3 italic">Bu eksiklikler yeni denetimde otomatik olarak iÅŸaretlenecektir.</p>
        </div>
       </div>
      </div><button id="start-audit-btn" class="modern-btn w-full py-4 bg-blue-500 text-white font-medium rounded-2xl hover:bg-blue-600 transition text-base mt-2"> Denetime BaÅŸla </button>
     </div>
    </div><!-- Veri Ä°Ã§eriÄŸi -->
    <div id="content-data" class="p-8 hidden bg-white rounded-3xl shadow-sm border border-gray-200"><!-- Ä°statistikler -->
     <div class="mb-6">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ“Š Ä°statistikler</h3>
      <div id="statistics-container" class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-4"></div>
     </div><!-- Denetim Listesi -->
     <div>
      <h3 class="text-lg font-semibold text-gray-900 mb-4">ğŸ“‹ KayÄ±tlÄ± Denetimler</h3>
      <div id="audit-history" class="space-y-3"></div>
     </div>
    </div><!-- Bilgi Ä°Ã§eriÄŸi -->
    <div id="content-info" class="p-8 hidden bg-white rounded-3xl shadow-sm border border-gray-200">
     <div class="space-y-6"><!-- Uygulama AmacÄ± -->
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6 border border-blue-100">
       <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">ğŸ¯ Uygulama AmacÄ±</h3>
       <p class="text-gray-700 leading-relaxed">Bu uygulama, okullarda Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi (Ä°SG) denetimlerini dijital ortamda kolayca gerÃ§ekleÅŸtirmek, kayÄ±t altÄ±na almak ve raporlamak iÃ§in geliÅŸtirilmiÅŸtir. Denetim sÃ¼reÃ§lerini hÄ±zlandÄ±rÄ±r ve standartlaÅŸtÄ±rÄ±r.</p>
      </div><!-- Ã–zellikler -->
      <div class="bg-gradient-to-r from-green-50 to-emerald-50 rounded-2xl p-6 border border-green-100">
       <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">âœ¨ Ã–zellikler</h3>
       <ul class="space-y-2 text-gray-700">
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>6 ana kategoride toplam 35 Ä°SG sorusu</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>Denetim sonuÃ§larÄ±nÄ± kaydetme ve geÃ§miÅŸ kayÄ±tlara eriÅŸim</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>Eksiklikler iÃ§in fotoÄŸraf ekleme desteÄŸi</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>Ã–zelleÅŸtirilebilir DÃ–F (DÃ¼zeltici Ã–nleyici Faaliyet) metinleri</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>PDF rapor oluÅŸturma ve indirme</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>Ã–nceki denetimlerdeki eksiklikleri takip etme</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>Ä°statistiksel veri analizi</span></li>
        <li class="flex items-start gap-2"><span class="text-green-600 font-bold">âœ“</span> <span>TÃ¼m veriler tarayÄ±cÄ±nÄ±zda gÃ¼venle saklanÄ±r</span></li>
       </ul>
      </div><!-- NasÄ±l KullanÄ±lÄ±r -->
      <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-6 border border-purple-100">
       <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">ğŸ“– NasÄ±l KullanÄ±lÄ±r?</h3>
       <ol class="space-y-2 text-gray-700 list-decimal list-inside">
        <li><strong>Yeni</strong> sekmesinden okul bilgilerini girin</li>
        <li><strong>Denetime BaÅŸla</strong> butonuna tÄ±klayÄ±n</li>
        <li>Her kategori iÃ§in sorularÄ± cevaplayÄ±n (Evet/HayÄ±r/Gerekli DeÄŸil)</li>
        <li>Eksiklikler iÃ§in fotoÄŸraf ekleyin ve notlar alÄ±n</li>
        <li>TÃ¼m kategorileri tamamlayÄ±p Ã¶zeti gÃ¶rÃ¼ntÃ¼leyin</li>
        <li>Denetimi kaydedin veya PDF olarak indirin</li>
        <li><strong>Veri</strong> sekmesinden geÃ§miÅŸ denetimleri inceleyin</li>
       </ol>
      </div><!-- Versiyon Bilgisi -->
      <div class="bg-gradient-to-r from-gray-50 to-slate-50 rounded-2xl p-6 border border-gray-200">
       <h3 class="text-lg font-semibold text-gray-900 mb-3 flex items-center gap-2">â„¹ï¸ Versiyon Bilgileri</h3>
       <div class="space-y-2 text-gray-700">
        <div class="flex justify-between"><span class="font-medium">Versiyon:</span> <span class="font-bold">57.0.0</span>
        </div>
        <div class="flex justify-between"><span class="font-medium">Tarih:</span> <span>Ocak 2025</span>
        </div>
        <div class="flex justify-between"><span class="font-medium">Platform:</span> <span>TÃ¼m Platformlar</span>
        </div>
       </div>
       <div class="mt-4 pt-4 border-t border-gray-200">
        <p class="text-sm text-gray-600 italic">ğŸ’¡ Ä°pucu: TÃ¼m verileriniz cihazÄ±nÄ±zda gÃ¼venle saklanÄ±r. TarayÄ±cÄ± geÃ§miÅŸini temizlerseniz verileriniz silinebilir.</p>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Personel Bilgileri SayfasÄ± -->
  <div id="personnel-page" class="hidden h-full overflow-auto">
   <div class="max-w-4xl mx-auto p-4 pb-20">
    <div class="bg-white rounded-3xl shadow-sm border border-gray-200 p-6 mb-4">
     <h2 class="text-2xl font-bold text-gray-900 mb-2 text-center">OKUL/KURUM Ã‡ALIÅAN SAYISI BÄ°LGÄ°LERÄ°</h2>
     <p id="personnel-school-info" class="text-center text-gray-500"></p>
    </div>
    <div class="bg-white rounded-3xl shadow-sm border border-gray-200 p-6">
     <div class="space-y-4">
      <div><label for="manager-count" class="block text-sm font-medium text-gray-700 mb-2">YÃ¶netici SayÄ±sÄ± *</label> <input type="number" id="manager-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="teacher-count" class="block text-sm font-medium text-gray-700 mb-2">Ã–ÄŸretmen SayÄ±sÄ± *</label> <input type="number" id="teacher-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="officer-count" class="block text-sm font-medium text-gray-700 mb-2">Memur SayÄ±sÄ± *</label> <input type="number" id="officer-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="servant-count" class="block text-sm font-medium text-gray-700 mb-2">Hizmetli SayÄ±sÄ± *</label> <input type="number" id="servant-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="worker-count" class="block text-sm font-medium text-gray-700 mb-2">Ä°ÅŸÃ§i SayÄ±sÄ± *</label> <input type="number" id="worker-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="typ-count" class="block text-sm font-medium text-gray-700 mb-2">TYP'li Personel SayÄ±sÄ± *</label> <input type="number" id="typ-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="paid-teacher-count" class="block text-sm font-medium text-gray-700 mb-2">Ãœcretli Ã–ÄŸretmen SayÄ±sÄ± *</label> <input type="number" id="paid-teacher-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="contract-count" class="block text-sm font-medium text-gray-700 mb-2">SÃ¶zleÅŸmeli Personel SayÄ±sÄ± *</label> <input type="number" id="contract-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="master-instructor-count" class="block text-sm font-medium text-gray-700 mb-2">Usta Ã–ÄŸretici SayÄ±sÄ± *</label> <input type="number" id="master-instructor-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="disabled-count" class="block text-sm font-medium text-gray-700 mb-2">Engelli Personel SayÄ±sÄ± *</label> <input type="number" id="disabled-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="exconvict-count" class="block text-sm font-medium text-gray-700 mb-2">Eski HÃ¼kÃ¼mlÃ¼ Personel SayÄ±sÄ± *</label> <input type="number" id="exconvict-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div><label for="chronic-count" class="block text-sm font-medium text-gray-700 mb-2">SÃ¼reÄŸen Kronik Hasta Personel SayÄ±sÄ± *</label> <input type="number" id="chronic-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalPersonnel()">
      </div>
      <div class="pt-4 border-t-2 border-blue-200"><label for="total-personnel" class="block text-base font-bold text-blue-900 mb-2">Toplam Personel SayÄ±sÄ±</label> <input type="number" id="total-personnel" readonly class="w-full px-4 py-4 bg-blue-50 border-2 border-blue-300 rounded-2xl font-bold text-xl text-blue-900 text-center" value="0">
      </div>
     </div>
    </div><!-- Ã–ÄŸrenci SayÄ±sÄ± Bilgileri -->
    <div class="bg-white rounded-3xl shadow-sm border border-gray-200 p-6 mt-4">
     <h2 class="text-2xl font-bold text-gray-900 mb-6 text-center">OKUL/KURUM Ã–ÄRENCÄ° SAYISI BÄ°LGÄ°LERÄ°</h2>
     <div class="space-y-4">
      <div><label for="normal-student-count" class="block text-sm font-medium text-gray-700 mb-2">Normal *</label> <input type="number" id="normal-student-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalStudents()">
      </div>
      <div><label for="disabled-student-count" class="block text-sm font-medium text-gray-700 mb-2">Engelli *</label> <input type="number" id="disabled-student-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalStudents()">
      </div>
      <div><label for="inclusion-student-count" class="block text-sm font-medium text-gray-700 mb-2">KaynaÅŸtÄ±rma *</label> <input type="number" id="inclusion-student-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalStudents()">
      </div>
      <div><label for="chronic-student-count" class="block text-sm font-medium text-gray-700 mb-2">SÃ¼reÄŸen Kronik Hasta *</label> <input type="number" id="chronic-student-count" min="0" value="0" class="modern-input w-full px-4 py-3 border border-gray-200 rounded-2xl focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" oninput="calculateTotalStudents()">
      </div>
      <div class="pt-4 border-t-2 border-green-200"><label for="total-students" class="block text-base font-bold text-green-900 mb-2">Toplam Ã–ÄŸrenci SayÄ±larÄ±</label> <input type="number" id="total-students" readonly class="w-full px-4 py-4 bg-green-50 border-2 border-green-300 rounded-2xl font-bold text-xl text-green-900 text-center" value="0">
      </div>
     </div>
     <div class="flex gap-3 mt-6"><button id="back-to-home" class="modern-btn flex-1 py-3.5 bg-white border border-gray-200 text-gray-700 font-medium rounded-2xl hover:bg-gray-50 transition"> â† Geri </button> <button id="continue-to-audit" class="modern-btn flex-1 py-3.5 bg-blue-600 text-white font-medium rounded-2xl hover:bg-blue-700 transition"> Denetime Devam Et â†’ </button>
     </div>
    </div>
   </div>
  </div><!-- Denetim SayfasÄ± -->
  <div id="audit-page" class="hidden h-full overflow-auto">
   <div class="max-w-4xl mx-auto p-4 pb-20"><!-- Ãœst Bilgi -->
    <div class="bg-white rounded-3xl shadow-sm border-2 border-blue-300 p-5 mb-4 sticky top-4 z-10">
     <div class="flex items-center justify-between mb-2">
      <h2 id="category-title" class="text-lg font-medium text-gray-900"></h2>
      <div id="progress-display" class="text-sm font-medium text-gray-500"></div>
     </div>
     <p id="school-info-display" class="text-sm text-gray-500 mb-3"></p><!-- Toplam istatistikler -->
     <div id="total-stats" class="grid grid-cols-3 gap-2 mb-3"></div>
     <div class="w-full bg-gray-100 rounded-full h-1.5">
      <div id="progress-bar" class="bg-blue-600 h-1.5 rounded-full transition-all" style="width: 0%"></div>
     </div>
    </div><!-- Sorular -->
    <div id="questions-container" class="space-y-4 mb-4"></div><!-- Navigasyon -->
    <div class="flex gap-3"><button id="prev-category" class="modern-btn flex-1 py-3.5 bg-white border border-gray-200 text-gray-700 font-medium rounded-2xl hover:bg-gray-50 transition"> â† Ã–nceki </button> <button id="next-category" class="modern-btn flex-1 py-3.5 bg-blue-600 text-white font-medium rounded-2xl hover:bg-blue-700 transition"> Sonraki â†’ </button>
    </div>
   </div>
  </div><!-- Ã–zet SayfasÄ± -->
  <div id="summary-page" class="hidden h-full overflow-auto">
   <div class="max-w-4xl mx-auto p-4 pb-20">
    <div class="bg-white rounded-3xl shadow-sm border border-gray-200 p-6 mb-4">
     <h2 class="text-2xl font-bold text-blue-900 mb-2 text-center tracking-tight">Denetim Ã–zeti</h2>
     <p class="text-center text-red-600 font-semibold">Denetim tamamlandÄ±! SonuÃ§larÄ± inceleyin.</p>
    </div>
    <div id="summary-content" class="space-y-4 mb-4"></div><!-- DiÄŸer DÃ–F GiriÅŸi BÃ¶lÃ¼mÃ¼ -->
    <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-3xl shadow-sm border border-purple-200 p-6 mb-4">
     <h3 class="text-lg font-bold text-purple-900 mb-3">ğŸ“ DiÄŸer DÃ–F (Ä°steÄŸe BaÄŸlÄ±)</h3>
     <p class="text-sm text-purple-700 mb-4">Sorular iÃ§erisinde yer almayan uygunsuzluklarÄ± buradan ekleyebilirsiniz.</p>
     <div id="other-dof-list" class="space-y-3 mb-4"></div>
     <div class="space-y-3"><input type="text" id="other-dof-text" class="w-full px-4 py-3 border border-purple-300 rounded-2xl focus:ring-2 focus:ring-purple-500 outline-none" placeholder="DÃ–F metnini girin..."> <button id="add-other-dof" class="w-full py-3 bg-purple-600 text-white font-medium rounded-2xl hover:bg-purple-700 transition"> â• DiÄŸer DÃ–F Ekle </button>
     </div>
    </div>
    <div id="detail-actions" class="space-y-3"><button id="back-to-audit" class="modern-btn w-full py-3.5 bg-white border border-gray-200 text-gray-700 font-medium rounded-2xl hover:bg-gray-50 transition"> â† Denetime Geri DÃ¶n </button> <button id="save-audit" class="modern-btn w-full py-3.5 bg-green-600 text-white font-medium rounded-2xl hover:bg-green-700 transition"> ğŸ’¾ Denetimi Kaydet </button> <button id="download-pdf" class="modern-btn w-full py-3.5 bg-gray-900 text-white font-medium rounded-2xl hover:bg-gray-800 transition"> ğŸ“„ PDF Ä°ndir </button>
    </div>
   </div>
  </div><!-- FotoÄŸraf Modal -->
  <div id="photo-modal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4">
   <div class="bg-white rounded-3xl max-w-md w-full p-8 shadow-2xl">
    <h3 class="text-xl font-medium text-gray-900 mb-6">FotoÄŸraf Ekle</h3>
    <div class="space-y-3 mb-6"><label for="camera-input" class="modern-btn block w-full py-3.5 bg-gray-900 text-white font-medium rounded-2xl text-center cursor-pointer hover:bg-gray-800 transition"> ğŸ“· Kamera ile Ã‡ek </label> <input type="file" id="camera-input" accept="image/*" capture="environment" class="hidden"> <label for="gallery-input" class="modern-btn block w-full py-3.5 bg-white border border-gray-200 text-gray-700 font-medium rounded-2xl text-center cursor-pointer hover:bg-gray-50 transition"> ğŸ–¼ï¸ Galeriden SeÃ§ </label> <input type="file" id="gallery-input" accept="image/*" class="hidden">
    </div>
    <div id="photo-preview-container" class="hidden mb-6"><img id="photo-preview" class="w-full h-48 object-cover rounded-2xl" alt="Preview">
    </div>
    <div class="flex gap-3"><button id="cancel-photo" class="modern-btn flex-1 py-3.5 bg-white border border-gray-200 text-gray-700 font-medium rounded-2xl hover:bg-gray-50 transition"> Ä°ptal </button> <button id="save-photo" class="modern-btn flex-1 py-3.5 bg-green-600 text-white font-medium rounded-2xl hover:bg-green-700 transition"> Kaydet </button>
    </div>
   </div>
  </div><!-- Detay Modal -->
  <div id="detail-modal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4 overflow-y-auto">
   <div class="bg-white rounded-3xl max-w-2xl w-full my-8 shadow-2xl">
    <div class="p-6 border-b border-gray-100 sticky top-0 bg-white rounded-t-3xl z-10">
     <div class="flex items-center justify-between">
      <h3 class="text-xl font-medium text-gray-900">Denetim DetaylarÄ±</h3><button onclick="closeDetailModal()" class="text-gray-400 hover:text-gray-600 text-2xl font-light">âœ•</button>
     </div>
    </div>
    <div id="detail-content" class="p-6 space-y-4 max-h-96 overflow-y-auto"></div>
    <div id="detail-actions-modal" class="p-6 border-t border-gray-100 space-y-3"></div>
   </div>
  </div>
  <script>
    // Denetim SorularÄ±
const auditQuestions = {
  A: {
    title: "Ä°Å SAÄLIÄI VE GÃœVENLÄ°ÄÄ° HÄ°ZMETLERÄ° YÃ–NETÄ°MÄ°",
    questions: [
      { code: "A1", text: "Ä°ÅŸveren Vekili GÃ¶revlendirmesi YapÄ±lmÄ±ÅŸ mÄ±? Ä°ÅŸveren OnaylamÄ±ÅŸ mÄ±? TebliÄŸ EdilmiÅŸ mi?", dof: "Ä°ÅŸveren vekili gÃ¶revlendirmesi yapÄ±lmalÄ±, iÅŸveren tarafÄ±ndan onaylanmalÄ± ve ilgili kiÅŸiye tebliÄŸ edilmelidir." },
      { code: "A2", text: "Ä°ÅŸ GÃ¼venliÄŸi UzmanÄ± GÃ¶revlendirmesi YapÄ±lmÄ±ÅŸ mÄ±? (6 Ayda Bir)", dof: "Ä°ÅŸ gÃ¼venliÄŸi uzmanÄ± gÃ¶revlendirmesi 6 aylÄ±k periyotlarla gÃ¼ncel tutulmalÄ±dÄ±r." },
      { code: "A3", text: "Ä°ÅŸyeri Hekimi GÃ¶revlendirmesi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Ä°ÅŸyeri hekimi gÃ¶revlendirmesi mevzuata uygun ÅŸekilde tamamlanmalÄ±dÄ±r." },
      { code: "A4", text: "Ã‡alÄ±ÅŸan Temsilcisi AtanmÄ±ÅŸ mÄ±? SeÃ§ilmiÅŸ mi? TebliÄŸ EdilmiÅŸ mi?", dof: "Ã‡alÄ±ÅŸan temsilcisi seÃ§imle veya atama yoluyla belirlenmeli ve gÃ¶rev tebliÄŸi yapÄ±lmalÄ±dÄ±r." },
      { code: "A5", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi DokÃ¼mantasyonu YapÄ±lÄ±yor mu?", dof: "Ä°SG mevzuatÄ±nÄ±n gerektirdiÄŸi tÃ¼m dokÃ¼mantasyon sÃ¼reci dÃ¼zenli olarak yÃ¼rÃ¼tÃ¼lmelidir." },
      { code: "A6", text: "Kurum Tespit ve Ã–neri Defteri Var mÄ±? KullanÄ±lÄ±yor mu?", dof: "Kurum Tespit ve Ã–neri Defteri temin edilmeli ve onaylÄ± ÅŸekilde aktif olarak kullanÄ±lmalÄ±dÄ±r." },
      { code: "A7", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Kurulu OluÅŸturulmuÅŸ mu? (Ã‡alÄ±ÅŸan SayÄ±sÄ± 50â€™nin Ã¼stÃ¼)", dof: "Ã‡alÄ±ÅŸan sayÄ±sÄ± 50â€™nin Ã¼zerinde ise Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Kurulu resmi olarak oluÅŸturulmalÄ±dÄ±r." },
      { code: "A8", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Kurulu ToplantÄ±larÄ± DÃ¼zenli Olarak YapÄ±lÄ±yor mu? (Az Tehlikeli: 3 Ayda Bir)", dof: "Ä°SG Kurulu toplantÄ±larÄ± az tehlikeli sÄ±nÄ±fa uygun olarak 3 ayda bir dÃ¼zenli gerÃ§ekleÅŸtirilmelidir." },
      { code: "A9", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Ekibi OluÅŸturulmuÅŸ mu? (Ã‡alÄ±ÅŸan SayÄ±sÄ± 50â€™nin altÄ±)", dof: "Ã‡alÄ±ÅŸan sayÄ±sÄ± 50â€™nin altÄ±nda olan birimlerde koordinasyonu saÄŸlayacak Ä°SG Ekibi kurulmalÄ±dÄ±r." },
      { code: "A10", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Ä°Ã§ YÃ¶nergesi HazÄ±rlanmÄ±ÅŸ mÄ±? Ä°ÅŸveren OnaylamÄ±ÅŸ mÄ±?", dof: "Kuruma Ã¶zel Ä°SG Ä°Ã§ YÃ¶nergesi hazÄ±rlanarak iÅŸveren onayÄ±na sunulmalÄ±dÄ±r." },
      { code: "A11", text: "YÄ±llÄ±k Ä°SG Ã‡alÄ±ÅŸma PlanÄ± HazÄ±rlanmÄ±ÅŸ mÄ±? Ä°SG Kurulu/Ekibi OnaylamÄ±ÅŸ mÄ±?", dof: "YÄ±llÄ±k Ä°SG Ã‡alÄ±ÅŸma PlanÄ± hazÄ±rlanmalÄ± ve yetkili kurul/ekip tarafÄ±ndan onaylanmalÄ±dÄ±r." },
      { code: "A12", text: "YÄ±llÄ±k Ä°SG DeÄŸerlendirme Raporu HazÄ±rlanmÄ±ÅŸ mÄ±? Ä°SG Kurulu/Ekibi OnaylamÄ±ÅŸ mÄ±?", dof: "YÄ±l sonunda Ä°SG DeÄŸerlendirme Raporu oluÅŸturularak kurul/ekip onayÄ±ndan geÃ§irilmelidir." },
      { code: "A13", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi KÃ¼ltÃ¼rÃ¼nÃ¼n YaygÄ±nlaÅŸtÄ±rÄ±lmasÄ± Ã‡alÄ±ÅŸmalarÄ± YapÄ±lÄ±yor mu?", dof: "Kurum genelinde Ä°SG kÃ¼ltÃ¼rÃ¼nÃ¼n yaygÄ±nlaÅŸtÄ±rÄ±lmasÄ±na yÃ¶nelik farkÄ±ndalÄ±k Ã§alÄ±ÅŸmalarÄ± yapÄ±lmalÄ±dÄ±r." },
      { code: "A14", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Panosu OluÅŸturulmuÅŸ mu?", dof: "Bilgilendirme ve gÃ¼ncel duyurular iÃ§in bir Ä°SG Panosu oluÅŸturulmalÄ±dÄ±r." },
      { code: "A15", text: "TS EN ISO 9001 Kalite YÃ¶netim Sistemi (KYS) Ã‡alÄ±ÅŸmasÄ± Var mÄ±?", dof: "TS EN ISO 9001 Kalite YÃ¶netim Sistemi standartlarÄ±na yÃ¶nelik Ã§alÄ±ÅŸmalar baÅŸlatÄ±lmalÄ±dÄ±r." },
      { code: "A16", text: "TS ISO 45001 Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi YÃ¶netim Sistemi (Ä°SGYS) Ã‡alÄ±ÅŸmasÄ± Var mÄ±?", dof: "TS ISO 45001 Ä°SG YÃ¶netim Sistemi standartlarÄ± kurum sÃ¼reÃ§lerine entegre edilmelidir." },
      { code: "A17", text: "TS ISO 14001 Ã‡evre YÃ¶netim Sistemi (Ã‡YS) Ã‡alÄ±ÅŸmasÄ± Var mÄ±?", dof: "TS ISO 14001 Ã‡evre YÃ¶netim Sistemi standartlarÄ±na uygunluk Ã§alÄ±ÅŸmalarÄ± yÃ¼rÃ¼tÃ¼lmelidir." },
      { code: "A18", text: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ Bilgileri GÃ¼ncel mi?", dof: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ Ã¼zerindeki tÃ¼m bilgiler sÃ¼rekli gÃ¼ncel tutulmalÄ±dÄ±r." }
    ]
  },
  B: {
    title: "RÄ°SK YÃ–NETÄ°MÄ°",
    questions: [
      { code: "B1", text: "Risk DeÄŸerlendirme Ekibi OluÅŸturulmuÅŸ mu? Ekip Ãœyelerine TebliÄŸ EdilmiÅŸ mi?", dof: "Risk DeÄŸerlendirme Ekibi oluÅŸturulmalÄ± ve gÃ¶revleri Ã¼yelere tebliÄŸ edilmelidir." },
      { code: "B2", text: "Risk DeÄŸerlendirmesi iÃ§in Kontrol Listesi (Checklist) HazÄ±rlanmÄ±ÅŸ mÄ±?", dof: "Risk deÄŸerlendirme sÃ¼reci iÃ§in kuruma Ã¶zgÃ¼ kontrol listeleri (checklist) hazÄ±rlanmalÄ±dÄ±r." },
      { code: "B3", text: "Risk DeÄŸerlendirmesi (Analizi) YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Kurumun tÃ¼m alanlarÄ±nÄ± kapsayan detaylÄ± bir Risk DeÄŸerlendirmesi (Analizi) yapÄ±lmalÄ±dÄ±r." },
      { code: "B4", text: "Risk Analiz Raporu HazÄ±rlanÄ±p MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ne GirilmiÅŸ mi?", dof: "HazÄ±rlanan Risk Analiz Raporu MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ne eksiksiz girilmelidir." },
      { code: "B5", text: "Ä°SGB ModÃ¼lÃ¼nden AlÄ±nan Risk Analiz Raporu Ekip Ãœyeleri TarafÄ±ndan Ä°mzalanmÄ±ÅŸ mÄ±?", dof: "MEBBÄ°Sâ€™ten alÄ±nan Ã§Ä±ktÄ±, risk deÄŸerlendirme ekibi Ã¼yelerine imzalattÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "B6", text: "Risk Analiz Raporu Ä°ÅŸveren TarafÄ±ndan Ä°mzalanmÄ±ÅŸ ve OnaylanmÄ±ÅŸ mÄ±?", dof: "Risk Analiz Raporu iÅŸveren tarafÄ±ndan incelenerek onaylanmalÄ±dÄ±r." },
      { code: "B7", text: "Risk Analiz Raporu GÃ¼ncelleniyor mu? (Az Tehlikeli: 6 YÄ±l, Tehlikeli: 4 YÄ±l)", dof: "Risk analizi tehlike sÄ±nÄ±fÄ±na gÃ¶re (Az Tehlikeli: 6, Tehlikeli: 4 yÄ±l) periyodik olarak gÃ¼ncellenmelidir." },
      { code: "B8", text: "Risk DeÄŸerlendirmesi YapÄ±lÄ±rken Periyodik Kontrol RaporlarÄ± Dikkate AlÄ±nÄ±yor mu?", dof: "Risk deÄŸerlendirmesi yapÄ±lÄ±rken teknik cihazlarÄ±n periyodik kontrol raporlarÄ± esas alÄ±nmalÄ±dÄ±r." },
      { code: "B9", text: "Riskler HakkÄ±nda Ã‡alÄ±ÅŸanlar BilgilendirilmiÅŸ mi?", dof: "Tespit edilen riskler ve alÄ±nmasÄ± gereken Ã¶nlemler hakkÄ±nda tÃ¼m Ã§alÄ±ÅŸanlara bilgi verilmelidir." },
      { code: "B10", text: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ Kurum Risk TabanlÄ± Ã–denek Sistemi KullanÄ±lÄ±yor mu?", dof: "Ä°SGB ModÃ¼lÃ¼ Ã¼zerinden 'Kurum Risk TabanlÄ± Ã–denek Sistemi' etkin ÅŸekilde kullanÄ±lmalÄ±dÄ±r." },
      { code: "B11", text: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ â€œKurum Risk DeÄŸerlendirme Ä°ÅŸlemleriâ€ BÃ¶lÃ¼mÃ¼ GÃ¼ncel mi?", dof: "Ä°SGB ModÃ¼lÃ¼ 'Kurum Risk DeÄŸerlendirme Ä°ÅŸlemleri' sekmesi sÃ¼rekli gÃ¼ncel tutulmalÄ±dÄ±r." }
    ]
  },
  C: {
    title: "ACÄ°L DURUM YÃ–NETÄ°MÄ°",
    questions: [
      { code: "C1", text: "Acil Durum Ekipleri OluÅŸturulmuÅŸ mu? Ekip Ãœyelerine TebliÄŸ EdilmiÅŸ mi?", dof: "Acil Durum Ekipleri kurulmalÄ± ve ekip gÃ¶revleri personele tebliÄŸ edilmelidir." },
      { code: "C2", text: "Acil Durumlar, Ã–nleyici SÄ±nÄ±rlayÄ±cÄ± Tedbirler, MÃ¼dahale ve Tahliye YÃ¶ntemleri BelirlenmiÅŸ mi?", dof: "Acil durum senaryolarÄ±, mÃ¼dahale ve tahliye yÃ¶ntemleri Ã¶nceden belirlenmelidir." },
      { code: "C3", text: "Acil Durum PlanÄ± Ä°ÅŸveren TarafÄ±ndan Ä°mzalanmÄ±ÅŸ ve OnaylanmÄ±ÅŸ mÄ±?", dof: "Acil Durum PlanÄ± iÅŸveren tarafÄ±ndan onaylanarak yÃ¼rÃ¼rlÃ¼ÄŸe konulmalÄ±dÄ±r." },
      { code: "C4", text: "Acil Durum Kat PlanlarÄ±, Acil Ã‡Ä±kÄ±ÅŸ YollarÄ± ve YÃ¶nlendirme Ä°ÅŸaretleri Her Katta Var mÄ±?", dof: "Her katta acil durum kat planlarÄ± ve yÃ¶nlendirme iÅŸaretleri standartlara uygun yerleÅŸtirilmelidir." },
      { code: "C5", text: "Ä°kaz/Alarm CihazÄ± ve Duman DedektÃ¶rleri/SensÃ¶rleri Ã‡alÄ±ÅŸÄ±r Durumda mÄ±?", dof: "Ä°kaz/alarm sistemleri ile duman dedektÃ¶rlerinin Ã§alÄ±ÅŸÄ±rlÄ±ÄŸÄ± periyodik test edilmelidir." },
      { code: "C6", text: "Acil Ã‡Ä±kÄ±ÅŸ KapÄ±larÄ± Var mÄ±?", dof: "Mevzuata uygun sayÄ±da ve konumda acil Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± tesis edilmelidir." },
      { code: "C7", text: "Acil Ã‡Ä±kÄ±ÅŸ KapÄ±larÄ± Standartlara Uygun mu?", dof: "Acil Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± panik barlÄ±, duman sÄ±zdÄ±rmaz ve yanmaya dayanÄ±klÄ± Ã¶zellikte olmalÄ±dÄ±r." },
      { code: "C8", text: "Okul/Kurum KapÄ±larÄ± DÄ±ÅŸarÄ± YÃ¶nde AÃ§Ä±lÄ±yor mu?", dof: "TÃ¼m kaÃ§Ä±ÅŸ ve ana Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± dÄ±ÅŸarÄ±ya (kaÃ§Ä±ÅŸ yÃ¶nÃ¼ne) aÃ§Ä±lacak ÅŸekilde dÃ¼zenlenmelidir." },
      { code: "C9", text: "Acil Ã‡Ä±kÄ±ÅŸ KapÄ±larÄ± ve YollarÄ± KullanÄ±mÄ± Engelleyecek Åekilde KapatÄ±lmÄ±ÅŸ mÄ±?", dof: "Acil Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± ve kaÃ§Ä±ÅŸ yollarÄ± her an aÃ§Ä±k ve engelsiz bulundurulmalÄ±dÄ±r." },
      { code: "C10", text: "Acil Durum Toplanma BÃ¶lgeleri BelirlenmiÅŸ mi?", dof: "Kurum dÄ±ÅŸÄ±nda gÃ¼venli bir 'Acil Durum Toplanma BÃ¶lgesi' belirlenmeli ve iÅŸaretlenmelidir." },
      { code: "C11", text: "Acil Durum TatbikatlarÄ± YapÄ±lÄ±yor mu?", dof: "Deprem, yangÄ±n ve tahliye gibi konularda dÃ¼zenli olarak acil durum tatbikatlarÄ± yapÄ±lmalÄ±dÄ±r." },
      { code: "C12", text: "Acil Durum PlanÄ± GÃ¼ncelleniyor mu?", dof: "Acil Durum PlanÄ±, tehlike sÄ±nÄ±fÄ±na uygun periyotlarda veya deÄŸiÅŸiklik durumunda revize edilmelidir." },
      { code: "C13", text: "Acil Durum TelefonlarÄ± Uygun Yerlere AsÄ±lmÄ±ÅŸ mÄ±?", dof: "Acil durum telefon numaralarÄ± listesi herkesin gÃ¶rebileceÄŸi noktalara asÄ±lmalÄ±dÄ±r." },
      { code: "C14", text: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ â€œKurum Acil Durum Ä°ÅŸlemleriâ€ BÃ¶lÃ¼mÃ¼ GÃ¼ncel mi?", dof: "MEBBÄ°S Ä°SGB ModÃ¼lÃ¼ 'Kurum Acil Durum Ä°ÅŸlemleri' bÃ¶lÃ¼mÃ¼ gÃ¼ncel verilerle doldurulmalÄ±dÄ±r." }
    ]
  },
  D: {
    title: "Ä°SG EÄÄ°TÄ°M, BÄ°LGÄ°LENDÄ°RME, KAYIT VE BÄ°LDÄ°RÄ°M YÃ–NETÄ°MÄ°",
    questions: [
      { code: "D1", text: "Ã‡alÄ±ÅŸanlarÄ±n Temel Ä°SG EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Ã‡alÄ±ÅŸanlarÄ±n zorunlu temel Ä°SG eÄŸitimleri yasal sÃ¼re ve saatlere uygun olarak tamamlanmalÄ±dÄ±r." },
      { code: "D2", text: "Ä°ÅŸ SaÄŸlÄ±ÄŸÄ± ve GÃ¼venliÄŸi Kurulu Ãœyeleri EÄŸitimi ve Bilgilendirmesi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Ä°SG Kurulu Ã¼yelerine Ã¶zel gÃ¶rev ve sorumluluk eÄŸitimleri verilmelidir." },
      { code: "D3", text: "Risk DeÄŸerlendirme Ekibi EÄŸitimi ve Bilgilendirmesi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Risk DeÄŸerlendirme Ekibine analiz yÃ¶ntemleri konusunda bilgilendirme yapÄ±lmalÄ±dÄ±r." },
      { code: "D4", text: "Acil Durum Ekipleri EÄŸitimi ve Bilgilendirmesi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Acil Durum Ekiplerine yangÄ±n, kurtarma ve ilkyardÄ±m konularÄ±nda Ã¶zel eÄŸitim verilmelidir." },
      { code: "D5", text: "YangÄ±n EÄŸitimi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "TÃ¼m personele ve Ã¶ÄŸrencilere temel yangÄ±n gÃ¼venliÄŸi eÄŸitimi saÄŸlanmalÄ±dÄ±r." },
      { code: "D6", text: "KiÅŸisel Koruyucu DonanÄ±m (KKD) ve BakÄ±m EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "KKD kullanmasÄ± gereken personele donanÄ±mlarÄ±n kullanÄ±mÄ± ve bakÄ±mÄ± eÄŸitimi verilmelidir." },
      { code: "D7", text: "Hijyen ve Sanitasyon EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Ä°lgili personelin hijyen ve sanitasyon eÄŸitimlerini almasÄ± saÄŸlanmalÄ±dÄ±r." },
      { code: "D8", text: "Ã–ÄŸrenci/Ã‡Ä±rak Ä°SG EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Ã–ÄŸrenci ve Ã§Ä±raklar iÃ§in seviyelerine uygun Ä°SG farkÄ±ndalÄ±k eÄŸitimleri dÃ¼zenlenmelidir." },
      { code: "D9", text: "Ã–zel Politika Gerektiren Personele Ã–zel Ä°SG EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Engelli, yaÅŸlÄ± veya gebe gibi Ã¶zel politika gerektiren personele Ã¶zel bilgilendirme yapÄ±lmalÄ±dÄ±r." },
      { code: "D10", text: "Kazan Dairesinden Sorumlu Personel AteÅŸleyici Belgesi EÄŸitimleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Kazan dairesi gÃ¶revlilerinin 'AteÅŸleyici Belgesi' ve gerekli teknik eÄŸitimleri tamamlanmalÄ±dÄ±r." },
      { code: "D11", text: "Ä°ÅŸÃ§i Olarak Ã‡alÄ±ÅŸanlara Ä°SG Talimat ve Tutanak Formu TebliÄŸ EdilmiÅŸ mi?", dof: "Ä°ÅŸÃ§i statÃ¼sÃ¼ndeki personele Ä°SG talimatlarÄ± yazÄ±lÄ± olarak tebliÄŸ edilmelidir." },
      { code: "D12", text: "Ã‡alÄ±ÅŸanlarÄ±n GÃ¶rev TalimatlarÄ± TebliÄŸ EdilmiÅŸ mi?", dof: "Her Ã§alÄ±ÅŸana kendi gÃ¶rev alanÄ±na Ã¶zgÃ¼ gÃ¶rev ve Ä°SG talimatlarÄ± verilmelidir." },
      { code: "D13", text: "Ä°ÅŸ KazasÄ± KayÄ±tlarÄ± Tutuluyor mu? Ä°ÅŸ KazasÄ± Bildirimleri YapÄ±lÄ±yor mu?", dof: "Meydana gelen iÅŸ kazalarÄ± kayÄ±t altÄ±na alÄ±nmalÄ± ve yasal sÃ¼resi (3 iÅŸ gÃ¼nÃ¼) iÃ§inde bildirilmelidir." },
      { code: "D14", text: "Meslek HastalÄ±ÄŸÄ± KayÄ±tlarÄ± Tutuluyor mu?", dof: "Meslek hastalÄ±ÄŸÄ± ÅŸÃ¼phesi veya tanÄ±sÄ± durumunda gerekli kayÄ±t ve bildirim sÃ¼reÃ§leri izlenmelidir." },
      { code: "D15", text: "Ramak Kala Olay KayÄ±tlarÄ± Tutuluyor mu?", dof: "Ramak kala olaylar iÃ§in bildirim kutusu oluÅŸturulmalÄ± ve bu olaylar analiz edilerek kayÄ±t altÄ±na alÄ±nmalÄ±dÄ±r." }
    ]
  },
  E: {
    title: "YANGIN SÄ°STEMÄ° VE YANGINLA MÃœCADELE YÃ–NETÄ°MÄ°",
    questions: [
      { code: "E1", text: "YangÄ±n Ã–nleme, SÃ¶ndÃ¼rme Ä°Ã§ DÃ¼zenleme ve TalimatÄ± Var mÄ±?", dof: "YangÄ±n Ã¶nleme ve sÃ¶ndÃ¼rmeye yÃ¶nelik kurum iÃ§i uygulama talimatlarÄ± hazÄ±rlanmalÄ±dÄ±r." },
      { code: "E2", text: "YangÄ±n Vukuunda Hareket TarzÄ± Tablosu GÃ¶rÃ¼lebilir Yerlere AsÄ±lmÄ±ÅŸ mÄ±?", dof: "YangÄ±n anÄ±nda izlenecek hareket tarzÄ±nÄ± gÃ¶steren tablolar gÃ¶rÃ¼nÃ¼r yerlere asÄ±lmalÄ±dÄ±r." },
      { code: "E3", text: "YangÄ±n TalimatlarÄ± Tablosu GÃ¶rÃ¼lebilir Yerde Bulunuyor mu?", dof: "Her katta ve riskli alanda yangÄ±n sÃ¶ndÃ¼rme talimatlarÄ± bulundurulmalÄ±dÄ±r." },
      { code: "E4", text: "YangÄ±n UyarÄ± Sistemi (KÄ±r-Bas) ButonlarÄ± Ã‡alÄ±ÅŸÄ±yor mu?", dof: "YangÄ±n uyarÄ± (kÄ±r-bas) butonlarÄ±nÄ±n yÄ±lda bir kez teknik kontrolÃ¼ yapÄ±lmalÄ±dÄ±r." },
      { code: "E5", text: "YangÄ±n AlgÄ±lama Sistemi Var mÄ±? Ã‡alÄ±ÅŸÄ±yor mu?", dof: "YangÄ±n algÄ±lama sisteminin iÅŸlevselliÄŸi yÄ±llÄ±k periyodik bakÄ±mlarla korunmalÄ±dÄ±r." },
      { code: "E6", text: "YangÄ±n SÃ¶ndÃ¼rme CihazlarÄ±nÄ±n BakÄ±mÄ± YapÄ±lÄ±yor mu?", dof: "YangÄ±n tÃ¼plerinin yÄ±llÄ±k kontrolleri yapÄ±lmalÄ±, 4 yÄ±lda bir ise dolum/deÄŸiÅŸim saÄŸlanmalÄ±dÄ±r." },
      { code: "E7", text: "YangÄ±n SÃ¶ndÃ¼rme CihazlarÄ± MekÃ¢na GÃ¶re SeÃ§ilmiÅŸ mi?", dof: "SÃ¶ndÃ¼rme cihazlarÄ±, kullanÄ±lacak alanÄ±n riskine (metal, elektrik, yaÄŸ vb.) uygun seÃ§ilmelidir." },
      { code: "E8", text: "YangÄ±n SÃ¶ndÃ¼rme CihazlarÄ± SayÄ±sÄ± Yeterli mi? Yerden 90 cm YÃ¼kseklikte mi?", dof: "YangÄ±n sÃ¶ndÃ¼rme cihazlarÄ± yeterli sayÄ±da olmalÄ± ve yerden 90 cm yÃ¼kseklikte sabitlenmelidir." },
      { code: "E9", text: "YangÄ±n DolaplarÄ± ve SÃ¶ndÃ¼rme CihazlarÄ±nÄ±n Ã–nÃ¼ AÃ§Ä±k mÄ±?", dof: "YangÄ±n dolaplarÄ±nÄ±n ve tÃ¼plerin Ã¶nÃ¼ne eriÅŸimi engelleyecek hiÃ§bir malzeme konulmamalÄ±dÄ±r." },
      { code: "E10", text: "YangÄ±n DolabÄ± Hortumu Standartlara Uygun mu?", dof: "YangÄ±n dolabÄ± hortumlarÄ± TS standartlarÄ±na uygun uzunlukta ve kalitede olmalÄ±dÄ±r." },
      { code: "E11", text: "YangÄ±n DolabÄ± Hortum BaÄŸlantÄ±sÄ± ve Makara SaÄŸlam mÄ±? Su Var mÄ±?", dof: "YangÄ±n dolaplarÄ±nda su basÄ±ncÄ± sÃ¼rekli kontrol edilmeli, makara sistemleri yaÄŸlanmalÄ±dÄ±r." },
      { code: "E12", text: "YangÄ±n DolabÄ± KapaÄŸÄ± Kolayca AÃ§Ä±lÄ±yor mu?", dof: "YangÄ±n dolabÄ± kapaklarÄ± kilitli tutulmamalÄ±, herkesÃ§e kolayca aÃ§Ä±labilir olmalÄ±dÄ±r." },
      { code: "E13", text: "YangÄ±n Tahliye KapÄ±larÄ± Standartlara Uygun mu?", dof: "TÃ¼m tahliye kapÄ±larÄ±nÄ±n yangÄ±n yÃ¶netmeliÄŸi standartlarÄ±na uygunluÄŸu denetlenmelidir." },
      { code: "E14", text: "YangÄ±n Merdiveni Var mÄ±?", dof: "Binada ihtiyaÃ§ duyulan noktalara standartlara uygun yangÄ±n merdiveni tesis edilmelidir." },
      { code: "E15", text: "Mevcut YangÄ±n Merdiveni Standartlara Uygun mu?", dof: "Mevcut yangÄ±n merdivenlerinin yapÄ±sal saÄŸlamlÄ±ÄŸÄ± kontrol edilmelidir." },
      { code: "E16", text: "YangÄ±n Merdiveni Ä°ÅŸlevsel Olarak KullanÄ±lÄ±r Durumda mÄ±?", dof: "YangÄ±n merdivenleri her zaman temiz, aydÄ±nlÄ±k ve kullanÄ±ma hazÄ±r tutulmalÄ±dÄ±r." },
      { code: "E17", text: "YangÄ±n Merdiveni Ä°htiyacÄ± Tespit EdilmiÅŸ mi?", dof: "BinanÄ±n mevcut durumuna gÃ¶re yangÄ±n merdiveni ihtiyacÄ± raporlanmalÄ±dÄ±r." },
      { code: "E18", text: "Mutfak DavlumbazÄ±nda Otomatik SÃ¶ndÃ¼rme Sistemi Var mÄ±?", dof: "Mutfak davlumbazlarÄ± iÃ§in otomatik sÃ¶ndÃ¼rme sistemi kurulumu deÄŸerlendirilmelidir." },
      { code: "E19", text: "Elektrik Ana DaÄŸÄ±tÄ±m OdasÄ±nda Uygun YangÄ±n SÃ¶ndÃ¼rme CihazÄ± Var mÄ±?", dof: "Elektrik ana daÄŸÄ±tÄ±m odalarÄ±nda elektrik yangÄ±nlarÄ±na uygun sÃ¶ndÃ¼rÃ¼cÃ¼ler (CO2 vb.) bulundurulmalÄ±dÄ±r." }
    ]
  },
  F: {
    title: "ELEKTRÄ°K TEHLÄ°KESÄ° YÃ–NETÄ°MÄ°",
    questions: [
      { code: "F1", text: "Elektrik Ana Panosunun AltÄ±nda YalÄ±tkan Paspas Mevcut mu?", dof: "Elektrik panolarÄ±nÄ±n Ã¶nÃ¼ndeki zemine yalÄ±tkan (izole) paspas yerleÅŸtirilmelidir." },
      { code: "F2", text: "Elektrik Ana DaÄŸÄ±tÄ±m OdasÄ± Standartlara Uygun mu?", dof: "Elektrik ana daÄŸÄ±tÄ±m odasÄ± dÄ±ÅŸ mÃ¼dahalelere kapalÄ± ve standartlara uygun olmalÄ±dÄ±r." },
      { code: "F3", text: "Elektrik Ana DaÄŸÄ±tÄ±m OdasÄ±nda Elektrik PlanÄ± ve Kolon ÅemasÄ± Mevcut mu?", dof: "Ana daÄŸÄ±tÄ±m odasÄ±nda gÃ¼ncel elektrik tesisat planÄ± ve kolon ÅŸemasÄ± asÄ±lÄ± durmalÄ±dÄ±r." },
      { code: "F4", text: "Elektrik Ana DaÄŸÄ±tÄ±m Panosunda KaÃ§ak AkÄ±m RÃ¶lesi Aktif mi? UyarÄ± LevhasÄ± Var mÄ±?", dof: "TÃ¼m panolarda uygun deÄŸerde KaÃ§ak AkÄ±m RÃ¶lesi bulunmalÄ± ve aktif Ã§alÄ±ÅŸmalÄ±dÄ±r." },
      { code: "F5", text: "Elektrik Ana DaÄŸÄ±tÄ±m Panosu Sigorta NumaralarÄ± ve Etiketleri Mevcut mu?", dof: "Panolardaki sigortalar besledikleri alanlara gÃ¶re etiketlenmeli ve isimlendirilmelidir." },
      { code: "F6", text: "Tali Elektrik PanolarÄ±nÄ±n BakÄ±mÄ± YapÄ±lÄ±yor mu?", dof: "Tali elektrik panolarÄ±nÄ±n kapaklarÄ± kapalÄ± tutulmalÄ± ve periyodik bakÄ±mlarÄ± yapÄ±lmalÄ±dÄ±r." },
      { code: "F7", text: "Tali Elektrik PanolarÄ±nda KaÃ§ak AkÄ±m RÃ¶lesi Aktif mi? UyarÄ± LevhasÄ± Var mÄ±?", dof: "Tali panolarda kaÃ§ak akÄ±m korumasÄ± ve uyarÄ± levhalarÄ± eksiksiz olmalÄ±dÄ±r." },
      { code: "F8", text: "Tali Elektrik PanolarÄ±nÄ±n Sigorta NumaralarÄ± ve Etiketleri Mevcut mu?", dof: "Panolardaki sigorta isimlendirmeleri kullanÄ±cÄ±larÄ±n anlayacaÄŸÄ± ÅŸekilde gÃ¼ncellenmelidir." },
      { code: "F9", text: "Islak/Nemli Alanlarda AÃ§Ä±kta YalÄ±tÄ±lmamÄ±ÅŸ Kablo, Priz veya Anahtar Var mÄ±?", dof: "Islak zeminlerdeki priz ve anahtarlar sÄ±zdÄ±rmaz (kapaklÄ±) hale getirilmelidir." },
      { code: "F10", text: "Elektrik PanolarÄ±nÄ±n Ã–nÃ¼ EriÅŸime Engel Olmayacak Åekilde AÃ§Ä±k mÄ±?", dof: "Elektrik panolarÄ±nÄ±n Ã¶nÃ¼ mÃ¼dahale mesafesini engelleyecek ÅŸekilde kapatÄ±lmamalÄ±dÄ±r." },
      { code: "F11", text: "Sonradan Eklenen Tesisatlar Ä°Ã§in Onay AlÄ±nmÄ±ÅŸ mÄ±? Antigron Kablo KullanÄ±lmÄ±ÅŸ mÄ±?", dof: "Ek tesisat iÅŸlerinde mutlaka onaylÄ± projeye sadÄ±k kalÄ±nmalÄ± ve uygun kablo (antigron) kullanÄ±lmalÄ±dÄ±r." },
      { code: "F12", text: "Ã‡atÄ± Elektrik TesisatÄ± Mevcut mu?", dof: "Ã‡atÄ± arasÄ± elektrik tesisatÄ± tehlike oluÅŸturmayacak ÅŸekilde izole edilmelidir." },
      { code: "F13", text: "Elektrik TesisatÄ±, 'Elektrik Ä°Ã§ Tesisat YÃ¶netmeliÄŸi'ne Uygun mu?", dof: "TÃ¼m elektrik tesisatÄ± 'Elektrik Ä°Ã§ Tesisat YÃ¶netmeliÄŸi' ÅŸartlarÄ±na gÃ¶re revize edilmelidir." }
    ]
  },
  G: {
    title: "KAZAN DAÄ°RESÄ° VE KALORÄ°FER YÃ–NETÄ°MÄ°",
    questions: [
      { code: "G1", text: "Kazan Dairesi Ä°SG TalimatlarÄ± GÃ¶rÃ¼nÃ¼r Yere AsÄ±lmÄ±ÅŸ mÄ±?", dof: "Kazan dairesine Ã¶zel Ä°SG talimatlarÄ± giriÅŸ kapÄ±sÄ±na asÄ±lmalÄ±dÄ±r." },
      { code: "G2", text: "Kazan Dairesi Ä°ÅŸletme ve BakÄ±m TalimatlarÄ± GÃ¶rÃ¼nÃ¼r Yere AsÄ±lmÄ±ÅŸ mÄ±?", dof: "KazanÄ±n iÅŸletme ve bakÄ±m talimatlarÄ± teknik personelin gÃ¶receÄŸi yere yerleÅŸtirilmelidir." },
      { code: "G3", text: "Kazan Dairesinde AteÅŸleyici Belgesi Olan Personel Var mÄ±? Belge AsÄ±lmÄ±ÅŸ mÄ±?", dof: "Kazan dairesinde sadece yetki belgeli (ateÅŸleyici) personel gÃ¶revlendirilmelidir." },
      { code: "G4", text: "Kazan Dairesi GÃ¶revlisinin (Kaloriferci) GÃ¶rev TanÄ±mÄ± TebliÄŸ EdilmiÅŸ mi?", dof: "Kaloriferci/gÃ¶revli personelin gÃ¶rev tanÄ±mÄ± yazÄ±lÄ± olarak yapÄ±lmalÄ± ve kendisine iletilmelidir." },
      { code: "G5", text: "Kazan Dairesi GÃ¶revlisine KKD Tutanakla Teslim EdilmiÅŸ mi ve KullanÄ±lÄ±yor mu?", dof: "GÃ¶revli personelin Ã§elik burunlu ayakkabÄ±, eldiven gibi KKD'leri kullanmasÄ± denetlenmelidir." },
      { code: "G6", text: "Kazan Dairesinin Temizlik, DÃ¼zen ve GÃ¼venliÄŸi SaÄŸlanmÄ±ÅŸ mÄ±?", dof: "Kazan dairesinde genel temizlik ve dÃ¼zen saÄŸlanmalÄ±, zemin kayganlÄ±ÄŸÄ± Ã¶nlenmelidir." },
      { code: "G7", text: "Kazan Dairesinin Temiz Hava GiriÅŸi ve HavalandÄ±rmasÄ± Mevzuata Uygun mu?", dof: "Kazan dairesinin havalandÄ±rma menfezleri asla kapatÄ±lmamalÄ±, mevzuata uygun olmalÄ±dÄ±r." },
      { code: "G8", text: "Kazan Dairesinde Acil Ã‡Ä±kÄ±ÅŸ ve Tehlike UyarÄ± LevhalarÄ± Var mÄ±?", dof: "Alan iÃ§erisinde acil Ã§Ä±kÄ±ÅŸ ve yÃ¶nlendirme levhalarÄ± eksiksiz bulundurulmalÄ±dÄ±r." },
      { code: "G9", text: "Kazan Dairesi KapÄ±larÄ± DÄ±ÅŸarÄ± DoÄŸru AÃ§Ä±lÄ±yor mu?", dof: "Kazan dairesi Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± dÄ±ÅŸa aÃ§Ä±lÄ±r ve kolayca tahliye saÄŸlar durumda olmalÄ±dÄ±r." },
      { code: "G10", text: "Kazan Dairesinde En Az 1 Adet 6 kgâ€™lÄ±k KKT YangÄ±n SÃ¶ndÃ¼rme CihazÄ± Var mÄ±?", dof: "Kazan dairesinde en az 1 adet 6 kg'lÄ±k KKT yangÄ±n sÃ¶ndÃ¼rme cihazÄ± bulundurulmalÄ±dÄ±r." },
      { code: "G11", text: "Kapasite 350 kW ÃœstÃ¼ndeyse YangÄ±n DolabÄ± ve En Az 2 Ã‡Ä±kÄ±ÅŸ Var mÄ±?", dof: "YÃ¼ksek kapasiteli (350 kW+) kazanlarda yangÄ±n dolabÄ± ve Ã§ift Ã§Ä±kÄ±ÅŸ zorunluluÄŸu saÄŸlanmalÄ±dÄ±r." },
      { code: "G12", text: "Kazan ile YanÄ±cÄ± Maddeler ArasÄ±nda BÃ¶lme Duvar Var mÄ±?", dof: "Kazan ile yanÄ±cÄ± malzeme depolarÄ± arasÄ±nda yangÄ±na dayanÄ±klÄ± bÃ¶lme duvar olmalÄ±dÄ±r." },
      { code: "G13", text: "Elektrik Panosu DÄ±ÅŸarÄ±da mÄ±? Acil Stop Butonu Ã‡alÄ±ÅŸÄ±yor mu?", dof: "Elektrik panosu oda dÄ±ÅŸÄ±nda olmalÄ±, oda iÃ§inde ise acil durdurma (stop) butonu Ã§alÄ±ÅŸmalÄ±dÄ±r." },
      { code: "G14", text: "Boru HatlarÄ±, Pompa ve Vanalar Ãœzerinde TanÄ±mlama Etiketleri Var mÄ±?", dof: "Tesisat Ã¼zerindeki vana ve borular sÄ±caklÄ±k/akÄ±ÅŸ yÃ¶nÃ¼ gibi bilgilerle tanÄ±mlanmalÄ±dÄ±r." },
      { code: "G15", text: "Kazan Dairesinde Duman DedektÃ¶rÃ¼ Var mÄ±?", dof: "Kazan dairesinde gaz sÄ±zÄ±ntÄ±sÄ±na karÅŸÄ± duman/gaz dedektÃ¶rÃ¼ bulundurulmalÄ±dÄ±r." },
      { code: "G16", text: "Kazan Dairesinde Gaz Kesme Ana VanasÄ± Mevcut mu?", dof: "Gaz kesme ana vanasÄ± (deprem/yangÄ±n vanasÄ±) eriÅŸilebilir ve Ã§alÄ±ÅŸÄ±r olmalÄ±dÄ±r." },
      { code: "G17", text: "Kazan Dairesinin Depo Olarak KullanÄ±lmasÄ± EngellenmiÅŸ mi?", dof: "Kazan dairesi asla depo veya malzeme muhafaza alanÄ± olarak kullanÄ±lmamalÄ±dÄ±r." }
    ]
  },
  H: {
    title: "ORTAM Ã–LÃ‡ÃœMLERÄ°, PERÄ°YODÄ°K KONTROLLER VE BAKIMLAR",
    questions: [
      { code: "H1", text: "Termal Konfor, GÃ¼rÃ¼ltÃ¼, Toz ve AydÄ±nlatma Ortam Ã–lÃ§Ã¼mleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Gerekli alanlarda aydÄ±nlatma, gÃ¼rÃ¼ltÃ¼ ve termal konfor Ã¶lÃ§Ã¼mleri akredite kurumlara yaptÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "H2", text: "Elektrik TesisatÄ±nÄ±n YÄ±llÄ±k Periyodik Kontrolleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Elektrik iÃ§ tesisat kontrolÃ¼ her yÄ±l yetkili mÃ¼hendislerce gerÃ§ekleÅŸtirilmelidir." },
      { code: "H3", text: "Topraklama TesisatÄ±nÄ±n YÄ±llÄ±k Periyodik Kontrolleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Topraklama Ã¶lÃ§Ã¼mleri yÄ±llÄ±k periyotlarla yapÄ±lmalÄ± ve raporlanmalÄ±dÄ±r." },
      { code: "H4", text: "Paratoner TesisatÄ±nÄ±n YÄ±llÄ±k Periyodik Kontrolleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Paratoner (yÄ±ldÄ±rÄ±mdan korunma) sisteminin yÄ±llÄ±k bakÄ±mÄ± ve Ã¶lÃ§Ã¼mÃ¼ tamamlanmalÄ±dÄ±r." },
      { code: "H5", text: "YangÄ±n Sistem ve EkipmanlarÄ±nÄ±n YÄ±llÄ±k KontrolÃ¼ YapÄ±lmÄ±ÅŸ mÄ±?", dof: "YangÄ±n tesisatÄ±nÄ±n (dolaplar, pompalar, hidrantlar) yÄ±llÄ±k teknik kontrolÃ¼ yapÄ±lmalÄ±dÄ±r." },
      { code: "H6", text: "BasÄ±nÃ§lÄ± Kaplar ve Kalorifer KazanÄ±nÄ±n YÄ±llÄ±k Periyodik Kontrolleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Kalorifer kazanÄ± ve basÄ±nÃ§lÄ± kaplarÄ±n yÄ±llÄ±k periyodik muayeneleri yaptÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "H7", text: "Varsa AsansÃ¶rlerin YÄ±llÄ±k Periyodik Kontrolleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "AsansÃ¶rlerin aylÄ±k bakÄ±mlarÄ± ve yÄ±llÄ±k periyodik kontrolleri (Mavi/YeÅŸil etiket) saÄŸlanmalÄ±dÄ±r." },
      { code: "H8", text: "Ä°ÅŸ EkipmanlarÄ±nÄ±n Envanteri Tutuluyor mu?", dof: "TÃ¼m iÅŸ ekipmanlarÄ±nÄ±n listesi (envanteri) ve bakÄ±m geÃ§miÅŸleri tutulmalÄ±dÄ±r." },
      { code: "H9", text: "Varsa JeneratÃ¶rÃ¼n BakÄ±m ve Kontrolleri DÃ¼zenli YapÄ±lÄ±yor mu?", dof: "JeneratÃ¶rlerin yÃ¼k testleri ve periyodik bakÄ±mlarÄ± aksatÄ±lmadan yapÄ±lmalÄ±dÄ±r." },
      { code: "H10", text: "TezgÃ¢h ve Makinelerin YÄ±llÄ±k BakÄ±mlarÄ± YapÄ±lÄ±p Kartlara Ä°ÅŸlenmiÅŸ mi?", dof: "AtÃ¶lye ve laboratuvarlardaki makinelerin bakÄ±m kartlarÄ± oluÅŸturulmalÄ± ve iÅŸlenmelidir." },
      { code: "H11", text: "KlimalarÄ±n BakÄ±mlarÄ± Periyodik Olarak YapÄ±lÄ±yor mu?", dof: "KlimalarÄ±n filtre temizliÄŸi ve genel bakÄ±mlarÄ± saÄŸlÄ±k ÅŸartlarÄ±na uygun yapÄ±lmalÄ±dÄ±r." },
      { code: "H12", text: "Su Deposu TemizliÄŸi ve Periyodik KontrolÃ¼ YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Su depolarÄ± yÄ±lda en az bir kez temizlenmeli ve dezenfekte edilmelidir." },
      { code: "H13", text: "Ä°Ã§me Suyu Analizleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "KullanÄ±m sularÄ±ndan numune alÄ±narak periyodik su analizleri yaptÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "H14", text: "YÄ±llÄ±k Baca TemizliÄŸi ve Emisyon Ã–lÃ§Ã¼mleri YaptÄ±rÄ±lmÄ±ÅŸ mÄ±?", dof: "DoÄŸal gazlÄ± sistemlerde baca temizliÄŸi ve emisyon Ã¶lÃ§Ã¼mleri yetkili servislere yaptÄ±rÄ±lmalÄ±dÄ±r." }
    ]
  },
  I: {
    title: "SAÄLIK GÃ–ZETÄ°MÄ°, GIDA GÃœVENLÄ°ÄÄ° VE Ä°LKYARDIM",
    questions: [
      { code: "I1", text: "Ã‡alÄ±ÅŸanlarÄ±n Ä°ÅŸe GiriÅŸ Muayeneleri YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Yeni iÅŸe giren her personelin iÅŸe giriÅŸ saÄŸlÄ±k raporu dosyalanmalÄ±dÄ±r." },
      { code: "I2", text: "Periyodik SaÄŸlÄ±k Muayeneleri DÃ¼zenli YapÄ±lÄ±yor mu?", dof: "Mevcut Ã§alÄ±ÅŸanlarÄ±n periyodik saÄŸlÄ±k muayeneleri zamanÄ±nda yenilenmelidir." },
      { code: "I3", text: "GÄ±da Ä°ÅŸletmesi (Kantin/Yemekhane) Denetimi Her Ay YapÄ±lÄ±yor mu?", dof: "Kantin ve yemekhaneler kurum denetim komisyonunca her ay dÃ¼zenli denetlenmelidir." },
      { code: "I4", text: "Okul SaÄŸlÄ±ÄŸÄ± ProgramÄ± (Muayene, Fiziksel Aktivite vb) UygulanÄ±yor mu?", dof: "Okul SaÄŸlÄ±ÄŸÄ± kapsamÄ±ndaki Ã¶ÄŸrenci muayeneleri ve fiziksel aktiviteler takip edilmelidir." },
      { code: "I5", text: "Kantin Risk DeÄŸerlendirmesi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Kantin/Yemekhane iÅŸletmesine Ã¶zel risk deÄŸerlendirmesi yaptÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "I6", text: "Kantin Fiziksel OrtamÄ± Hijyen ve GÃ¼venliÄŸe Uygun mu?", dof: "GÄ±da iÅŸletmelerinin zemin, aydÄ±nlatma ve hijyen ÅŸartlarÄ± standartlara getirilmelidir." },
      { code: "I7", text: "Kantin Ã‡alÄ±ÅŸanlarÄ± GÃ¶rev Elbiselerini ve KKDâ€™lerini KullanÄ±yor mu?", dof: "GÄ±da Ã§alÄ±ÅŸanlarÄ±nÄ±n Ã¶nlÃ¼k, bone ve eldiven gibi KKD kullanÄ±mlarÄ± denetlenmelidir." },
      { code: "I8", text: "TarÄ±m BakanlÄ±ÄŸÄ± OnaylÄ± GÄ±da Ä°ÅŸletmesi Ã–zel Hijyen Belgesi Var mÄ±?", dof: "Ä°ÅŸletmenin TarÄ±m ve Orman BakanlÄ±ÄŸÄ±â€™ndan gerekli izinleri/belgeleri tamamlanmalÄ±dÄ±r." },
      { code: "I9", text: "Halk EÄŸitim OnaylÄ± Hijyen EÄŸitim Belgesi Var mÄ±?", dof: "Mutfak ve kantin personelinin hijyen eÄŸitim belgeleri gÃ¼ncellenmelidir." },
      { code: "I10", text: "GÄ±da Maddelerinin Temini ve DepolanmasÄ± Standartlara Uygun mu?", dof: "GÄ±da maddeleri soÄŸuk zincir bozulmadan ve uygun depolama ÅŸartlarÄ±nda saklanmalÄ±dÄ±r." },
      { code: "I11", text: "GÄ±da Sunum ve TÃ¼ketim AlanlarÄ± Uygun mu?", dof: "Yemek yeme ve sunum alanlarÄ± haÅŸerelere karÅŸÄ± korunaklÄ± ve temiz olmalÄ±dÄ±r." },
      { code: "I12", text: "LPG KullanÄ±lÄ±yorsa BaÄŸlantÄ± Emniyeti SaÄŸlanmÄ±ÅŸ mÄ±? TÃ¼pler Bina DÄ±ÅŸÄ±nda mÄ±?", dof: "LPG tÃ¼pleri mutlaka bina dÄ±ÅŸÄ±nda, korunaklÄ± ve emniyetli ÅŸekilde konumlandÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "I13", text: "ZararlÄ± HaÅŸerelere KarÅŸÄ± Ä°laÃ§lama YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Bina genelinde zararlÄ± haÅŸerelere karÅŸÄ± periyodik ilaÃ§lama programÄ± uygulanmalÄ±dÄ±r." },
      { code: "I14", text: "Varsa Revir OrtamÄ± Ä°htiyaÃ§lara Uygun mu?", dof: "Revir imkÃ¢nlarÄ± geliÅŸtirilmeli ve tÄ±bbi atÄ±k yÃ¶netimi saÄŸlanmalÄ±dÄ±r." },
      { code: "I15", text: "Kurumda GÃ¶revli HemÅŸire Var mÄ±?", dof: "Kurumda saÄŸlÄ±k personeli (hemÅŸire) istihdamÄ± veya gÃ¶revlendirmesi planlanmalÄ±dÄ±r." },
      { code: "I16", text: "Ä°lkyardÄ±m DolaplarÄ± EriÅŸilebilir mi? TÄ±bbi Malzeme EksiÄŸi Var mÄ±?", dof: "Ä°lkyardÄ±m dolaplarÄ± her an ulaÅŸÄ±labilir olmalÄ± ve iÃ§indeki malzemeler tamamlanmalÄ±dÄ±r." }
    ]
  },
  J: {
    title: "ATIK YÃ–NETÄ°MÄ°",
    questions: [
      { code: "J1", text: "AtÄ±klarÄ±n KontrolÃ¼ ve AyrÄ±ÅŸtÄ±rÄ±lmasÄ± YapÄ±lÄ±yor mu?", dof: "AtÄ±klar kaynaÄŸÄ±ndan (kaÄŸÄ±t, plastik, metal vb.) ayrÄ±ÅŸtÄ±rÄ±larak toplanmalÄ±dÄ±r." },
      { code: "J2", text: "Yeterli SayÄ±da AÄŸzÄ± KapaklÄ± ve PedallÄ± Ã‡Ã¶p Kutusu Var mÄ±?", dof: "Ã‡Ã¶p kutularÄ± hijyen aÃ§Ä±sÄ±ndan mutlaka pedallÄ± ve kapaklÄ± modellerden seÃ§ilmelidir." },
      { code: "J3", text: "Kimyasal AtÄ±klar (Pil, YaÄŸ vb.) AyrÄ± ToplanÄ±yor mu?", dof: "AtÄ±k piller ve bitkisel yaÄŸlar iÃ§in Ã¶zel toplama noktalarÄ± oluÅŸturulmalÄ±dÄ±r." },
      { code: "J4", text: "SÄ±fÄ±r AtÄ±k Projesi UygulanÄ±yor mu? EÃ‡BS Sistemine Veri GiriÅŸi YapÄ±lmÄ±ÅŸ mÄ±?", dof: "SÄ±fÄ±r AtÄ±k projesi kapsamÄ±nda EÃ‡BS sistemine dÃ¼zenli veri giriÅŸi yapÄ±lmalÄ±dÄ±r." },
      { code: "J5", text: "Temel Seviye SÄ±fÄ±r AtÄ±k Belgesi AlÄ±nmÄ±ÅŸ mÄ±?", dof: "Gerekli ÅŸartlar saÄŸlanarak kurum iÃ§in Temel Seviye SÄ±fÄ±r AtÄ±k Belgesi alÄ±nmalÄ±dÄ±r." }
    ]
  },
  K: {
    title: "GENEL FÄ°ZÄ°KÄ° ÅARTLAR (BahÃ§e, Merdiven, Korkuluk, Ã‡atÄ±)",
    questions: [
      { code: "K1", text: "GiriÅŸ KapÄ±sÄ± GÃ¼venliÄŸi SaÄŸlanmÄ±ÅŸ mÄ±? ZiyaretÃ§i KaydÄ± Tutuluyor mu?", dof: "GiriÅŸlerde ziyaretÃ§i kayÄ±t sistemi kurulmalÄ± ve Ã§evre duvarÄ± gÃ¼venliÄŸi artÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "K2", text: "BahÃ§e Yaya ve AraÃ§ GiriÅŸleri Birbirinden AyrÄ±lmÄ±ÅŸ mÄ±?", dof: "BahÃ§ede araÃ§ yolu ve yaya yolu Ã§izgilerle/bariyerlerle net ÅŸekilde ayrÄ±lmalÄ±dÄ±r." },
      { code: "K3", text: "BahÃ§e KapÄ±sÄ±nÄ±n Devrilme ve SÄ±kÄ±ÅŸmaya KarÅŸÄ± KontrolÃ¼ YapÄ±lmÄ±ÅŸ mÄ±?", dof: "BahÃ§e kapÄ±larÄ±nÄ±n raydan Ã§Ä±kma veya devrilme riskine karÅŸÄ± emniyet stoperleri takÄ±lmalÄ±dÄ±r." },
      { code: "K4", text: "BahÃ§e Ä°Ã§inde GÃ¼venli Park AlanÄ± Mevcut mu?", dof: "AraÃ§lar iÃ§in belirlenmiÅŸ, yaya trafiÄŸini etkilemeyen gÃ¼venli park alanlarÄ± oluÅŸturulmalÄ±dÄ±r." },
      { code: "K5", text: "BahÃ§e DuvarlarÄ± ve Korkuluklar GÃ¼venli mi?", dof: "BahÃ§e duvarlarÄ± Ã¼zerindeki korkuluklarÄ±n kesici/yÄ±rttÄ±cÄ± Ã¶zellikleri giderilmelidir." },
      { code: "K6", text: "BahÃ§e Zeminindeki Ã‡ukur ve Engeller Ä°Ã§in Ã–nlem AlÄ±nmÄ±ÅŸ mÄ±?", dof: "BahÃ§e zeminindeki tÃ¼m Ã§ukurlar kapatÄ±lmalÄ±, zemin bozukluklarÄ± onarÄ±lmalÄ±dÄ±r." },
      { code: "K7", text: "BahÃ§e Duvar Ekleri Kesme ve YÄ±kÄ±lma Riskine KarÅŸÄ± Kontrol EdilmiÅŸ mi?", dof: "YÄ±kÄ±lma riski taÅŸÄ±yan duvar veya eklentiler iÃ§in ivedilikle Ã¶nlem alÄ±nmalÄ±dÄ±r." },
      { code: "K8", text: "Spor Direkleri (Basketbol, Kale vb.) Devrilmeye KarÅŸÄ± SabitlenmiÅŸ mi?", dof: "Basketbol potalarÄ± ve kale direkleri devrilmeyecek ÅŸekilde yere sabitlenmelidir." },
      { code: "K9", text: "BahÃ§e Ã‡Ä±kÄ±ÅŸlarÄ± DoÄŸrudan GÃ¼venli Alana AÃ§Ä±lÄ±yor mu?", dof: "Bina Ã§Ä±kÄ±ÅŸlarÄ±nÄ±n doÄŸrudan caddeye deÄŸil, gÃ¼venli bahÃ§e alanÄ±na aÃ§Ä±lmasÄ± saÄŸlanmalÄ±dÄ±r." },
      { code: "K10", text: "Åiddetli RÃ¼zgÃ¢ra KarÅŸÄ± (Ã‡atÄ±, Pano vb.) Ã–nlemler AlÄ±nmÄ±ÅŸ mÄ±?", dof: "Ã‡atÄ± levhalarÄ±, tabelalar ve klimalar ÅŸiddetli rÃ¼zgÃ¢ra karÅŸÄ± sabitlenmelidir." },
      { code: "K11", text: "Su Kuyusu Varsa GÃ¼venlik KapaÄŸÄ± ve Kilidi Mevcut mu?", dof: "BahÃ§edeki su kuyularÄ± ve rÃ¶garlar kilitli aÄŸÄ±r kapaklarla emniyete alÄ±nmalÄ±dÄ±r." },
      { code: "K12", text: "BahÃ§e Zemininde AÃ§Ä±k RÃ¶gar veya Sivri Materyal Var mÄ±?", dof: "BahÃ§e zemininde su birikintisi ve buzlanmaya karÅŸÄ± drenaj Ã§alÄ±ÅŸmalarÄ± yapÄ±lmalÄ±dÄ±r." },
      { code: "K13", text: "Merdivenlerde KaydÄ±rmaz Bant UygulamasÄ± YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Merdiven basamaklarÄ±na aÅŸÄ±nmaya dayanÄ±klÄ± kaydÄ±rmaz bantlar yapÄ±ÅŸtÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "K14", text: "Merdiven BoÅŸluklarÄ± (GÃ¼venlik Filesi vb.) Ä°Ã§in Ã–nlem AlÄ±nmÄ±ÅŸ mÄ±?", dof: "Merdiven boÅŸluklarÄ±na yÃ¼ksekten dÃ¼ÅŸmeyi Ã¶nleyici gÃ¼venlik fileleri veya korkuluklar monte edilmelidir." },
      { code: "K15", text: "Engelli EriÅŸimi (Rampa, AsansÃ¶r vb.) SaÄŸlanmÄ±ÅŸ mÄ±?", dof: "Engelli rampalarÄ± ve tuvaletleri standartlara (eÄŸim ve geniÅŸlik) uygun hale getirilmelidir." },
      { code: "K16", text: "Merdiven BasamaklarÄ± Standart Ã–lÃ§Ã¼lere Uygun mu?", dof: "Merdiven basamak yÃ¼kseklikleri ve geniÅŸlikleri tÃ¼m kullanÄ±cÄ±lar iÃ§in eÅŸitlenmelidir." },
      { code: "K17", text: "Merdiven KÃ¼peÅŸte YÃ¼ksekliÄŸi Standartlara Uygun mu?", dof: "Merdivenlerdeki korkuluklar saÄŸlamlaÅŸtÄ±rÄ±lmalÄ± ve uygun yÃ¼ksekliÄŸe getirilmelidir." },
      { code: "K18", text: "DÃ¶rt Basamaktan Fazla Olan TÃ¼m Merdivenlerde Korkuluk Var mÄ±?", dof: "Basamak sayÄ±sÄ± 4â€™ten fazla olan tÃ¼m merdivenlerde tutamak (kÃ¼peÅŸte) bulundurulmalÄ±dÄ±r." },
      { code: "K19", text: "Korkuluk YÃ¼ksekliÄŸi En Az 90 cm mi?", dof: "Korkuluk yÃ¼ksekliÄŸinin tÃ¼m alanlarda en az 90 cm olmasÄ± saÄŸlanmalÄ±dÄ±r." },
      { code: "K20", text: "Korkuluk AralÄ±klarÄ± Ã‡ocuklarÄ±n DÃ¼ÅŸmesini Engelleyecek Kadar Dar mÄ±?", dof: "Korkuluk dikme aralÄ±klarÄ± Ã§ocuklarÄ±n baÅŸÄ±nÄ±n geÃ§emeyeceÄŸi (max 10-12 cm) aralÄ±kta olmalÄ±dÄ±r." },
      { code: "K21", text: "KorkuluklarÄ±n Ãœzerinde KaymayÄ± Engelleyecek Tedbir AlÄ±nmÄ±ÅŸ mÄ±?", dof: "Merdiven kenarlarÄ± kaymaya veya takÄ±lmaya neden olmayacak ÅŸekilde dÃ¼zenlenmelidir." },
      { code: "K22", text: "Uygun Olmayan Eski Korkuluklar Ä°Ã§in Ä°yileÅŸtirme YapÄ±lmÄ±ÅŸ mÄ±?", dof: "Standart dÄ±ÅŸÄ± olan tÃ¼m korkuluk sistemleri teknik rapor doÄŸrultusunda yenilenmelidir." },
      { code: "K23", text: "RampalarÄ±n EÄŸimi ve KorkuluklarÄ± Tekerlekli Sandalyeye Uygun mu?", dof: "RampalarÄ±n zeminleri Ä±slakken kaymayacak malzeme ile kaplanmalÄ±dÄ±r." },
      { code: "K24", text: "Kimyasallar Kilitli ve IÅŸÄ±k Almayan Depolarda mÄ± SaklanÄ±yor?", dof: "Temizlik kimyasallarÄ± kilitli dolaplarda, orijinal etiketli ambalajlarÄ±nda saklanmalÄ±dÄ±r." },
      { code: "K25", text: "SÄ±nÄ±f KapÄ±larÄ±nda Parmak SÄ±kÄ±ÅŸmasÄ±nÄ± Ã–nleyici Aparat Var mÄ±?", dof: "KapÄ±larda parmak sÄ±kÄ±ÅŸmasÄ±nÄ± Ã¶nleyici aparatlar (menteÅŸe koruyucu) kullanÄ±lmalÄ±dÄ±r." },
      { code: "K26", text: "SÄ±nÄ±f KapÄ±larÄ± DÄ±ÅŸarÄ±ya AÃ§Ä±lÄ±yor mu ve Ã–nleri Ä°ÅŸaretlenmiÅŸ mi?", dof: "SÄ±nÄ±f kapÄ±larÄ±nÄ±n aÃ§Ä±lma yÃ¶nÃ¼ koridor trafiÄŸini engellemeyecek ÅŸekilde iÅŸaretlenmelidir." },
      { code: "K27", text: "Pencerelerin AÃ§Ä±lma Mesafesi (DÃ¼ÅŸmeyi Ã–nleyecek Åekilde) SÄ±nÄ±rlandÄ±rÄ±lmÄ±ÅŸ mÄ±?", dof: "Pencerelere belirli bir aÃ§Ä±dan fazla aÃ§Ä±lmasÄ±nÄ± Ã¶nleyen emniyet kilitleri takÄ±lmalÄ±dÄ±r." },
      { code: "K28", text: "Cam KapÄ± ve BÃ¶lmelerde KÄ±rÄ±lmaya KarÅŸÄ± GÃ¼venlik Filmi Var mÄ±?", dof: "AlÃ§ak seviyedeki cam bÃ¶lmeler, Ã§arpma anÄ±nda daÄŸÄ±lmayan gÃ¼venlik filmi ile kaplanmalÄ±dÄ±r." },
      { code: "K29", text: "Islak Zeminlerde Kayma Riskine KarÅŸÄ± UyarÄ± LevhasÄ± KullanÄ±lÄ±yor mu?", dof: "Islak alan giriÅŸlerine Kaygan Zemin uyarÄ± levhalarÄ± yerleÅŸtirilmelidir." },
      { code: "K30", text: "Zeminlerdeki Kot FarklarÄ± Belirgin Hale GetirilmiÅŸ mi?", dof: "Zeminlerdeki ufak kot farklarÄ± sarÄ±-siyah ikaz bantlarÄ± ile belirginleÅŸtirilmelidir." },
      { code: "K31", text: "Dolap, KitaplÄ±k vb. EÅŸyalar Duvara SabitlenmiÅŸ mi? (L-Braket ile)", dof: "KitaplÄ±klar, dolaplar ve aÄŸÄ±r eÅŸyalar devrilmeye karÅŸÄ± duvara sabitlenmelidir." },
      { code: "K32", text: "Kalorifer Petekleri Keskin KÃ¶ÅŸelere KarÅŸÄ± KorunmuÅŸ mu?", dof: "Keskin kÃ¶ÅŸeli kalorifer peteklerine koruyucu yumuÅŸak kenarlÄ±klar takÄ±lmalÄ±dÄ±r." },
      { code: "K33", text: "Fiziki AlanlarÄ±n Genel TemizliÄŸi ve Hijyeni Uygun mu?", dof: "Tuvaletler ve ortak alanlar iÃ§in gÃ¼nlÃ¼k temizlik takip Ã§izelgeleri uygulanmalÄ±dÄ±r." },
      { code: "K34", text: "Ã‡atÄ± KapÄ±sÄ± Kilitli mi? EriÅŸimi EngellenmiÅŸ mi?", dof: "Ã‡atÄ± Ã§Ä±kÄ±ÅŸ kapÄ±larÄ± her zaman kilitli ve sadece yetkili eriÅŸimine aÃ§Ä±k tutulmalÄ±dÄ±r." },
      { code: "K35", text: "Ã‡atÄ±nÄ±n Depo Olarak KullanÄ±lmasÄ± EngellenmiÅŸ mi?", dof: "Ã‡atÄ± aralarÄ± yanÄ±cÄ± malzeme ve atÄ±klardan tamamen arÄ±ndÄ±rÄ±lmalÄ±dÄ±r." },
      { code: "K36", text: "Makine ve AraÃ§larÄ±n Kullanma TalimatlarÄ± Ãœzerinde mi?", dof: "KullanÄ±lan her tÃ¼rlÃ¼ makine iÃ§in kÄ±sa ve Ã¶z KullanÄ±m TalimatÄ± asÄ±lmalÄ±dÄ±r." },
      { code: "K37", text: "Ã–zel AmaÃ§lÄ± Ä°ÅŸ EkipmanlarÄ±nÄ±n TalimatlarÄ± Mevcut mu?", dof: "Ã–zel ekipmanlar (asansÃ¶r, jeneratÃ¶r vb.) iÃ§in acil mÃ¼dahale talimatlarÄ± hazÄ±rlanmalÄ±dÄ±r." },
      { code: "K38", text: "GÃ¼venlik KameralarÄ± TÃ¼m KÃ¶r NoktalarÄ± GÃ¶rÃ¼yor mu?", dof: "Kamera sisteminin kÃ¶r noktalarÄ± belirlenerek gÃ¼venlik aÄŸÄ± geniÅŸletilmelidir." },
      { code: "K39", text: "TÃ¼m Odalar ve BÃ¶lÃ¼mler TanÄ±mlayÄ±cÄ± Levhalarla Ä°simlendirilmiÅŸ mi?", dof: "TÃ¼m birimlerin kapÄ± isimlikleri ve yÃ¶nlendirme tabelalarÄ± standart hale getirilmelidir." },
      { code: "K40", text: "Tuvaletlerin Fiziki OrtamÄ± (AydÄ±nlatma, HavalandÄ±rma vb.) Uygun mu?", dof: "Tuvaletlerde koku ve nemi Ã¶nlemek iÃ§in havalandÄ±rma sistemleri iyileÅŸtirilmelidir." },
      { code: "K41", text: "Tuvaletler Hijyen KurallarÄ±na Uygun mu?", dof: "Tuvalet zeminleri dezenfektanlarla dÃ¼zenli olarak temizlenmelidir." },
      { code: "K42", text: "Tuvaletlerde Temizlik Malzemeleri GÃ¼venli Yerlerde mi Tutuluyor?", dof: "Temizlik maddeleri tuvaletlerde aÃ§Ä±kta deÄŸil, kapalÄ± dolaplarda tutulmalÄ±dÄ±r." },
      { code: "K43", text: "Tuvalet Temizlik Ã‡izelgeleri GÃ¼nlÃ¼k Olarak Ä°ÅŸleniyor mu?", dof: "Temizlik sonrasÄ± Ä±slak zeminler kurulanmalÄ± ve gerekli ikazlar konulmalÄ±dÄ±r." }
    ]
  },
  L: {
    title: "MESLEKÄ° VE TEKNÄ°K ANADOLU LÄ°SESÄ° Ä°SG",
    questions: [
      { code: "L1", text: "11. SÄ±nÄ±f Ã–ÄŸrencilerine Ä°ME Ã–ncesi Ä°SG EÄŸitimi VerilmiÅŸ mi?", dof: "11. SÄ±nÄ±f Ã¶ÄŸrencilerine staj Ã¶ncesi yoÄŸunlaÅŸtÄ±rÄ±lmÄ±ÅŸ Ä°SG eÄŸitimi verilmelidir." },
      { code: "L2", text: "Ä°ÅŸletmelerde Beceri EÄŸitimi GÃ¶ren Ã–ÄŸrencilerin Ä°SG EÄŸitimleri Takip Ediliyor mu?", dof: "Ä°ÅŸletmelerdeki Ã¶ÄŸrencilerin Ã§alÄ±ÅŸma ÅŸartlarÄ± ve KKD kullanÄ±mlarÄ± periyodik denetlenmelidir." },
      { code: "L3", text: "Ä°ME Ã–ncesi Ä°ÅŸe GiriÅŸ Muayene RaporlarÄ± DosyalanmÄ±ÅŸ mÄ±?", dof: "Stajyer Ã¶ÄŸrencilerin iÅŸe giriÅŸ muayene raporlarÄ± eksiksiz ÅŸekilde dosyalanmalÄ±dÄ±r." }
    ]
  }
};

  const categoryOrder = [
  'A', 'B', 'C', 'D', 
  'E', 'F', 'G', 'H',
  'I', 'J', 'K', 'L'
];

    // Uygulama Durumu
    const appState = {
      schoolCode: '',
      schoolName: '',
      schoolDistrict: '',
      auditDate: '',
      schoolAddress: '',
      schoolScope: '',
      schoolHazardClass: '',
      schoolPhone: '',
      schoolEmail: '',
      managerCount: 0,
      teacherCount: 0,
      officerCount: 0,
      servantCount: 0,
      workerCount: 0,
      typCount: 0,
      paidTeacherCount: 0,
      contractCount: 0,
      masterInstructorCount: 0,
      disabledCount: 0,
      exconvictCount: 0,
      chronicCount: 0,
      totalPersonnel: 0,
      normalStudentCount: 0,
      disabledStudentCount: 0,
      inclusionStudentCount: 0,
      chronicStudentCount: 0,
      totalStudents: 0,
      currentCategoryIndex: 0,
      currentPage: 'home',
      answers: {},
      photos: {},
      allAudits: [],
      currentPhotoQuestion: null,
      editingAuditId: null,
      previousDeficiencies: [],
      otherDeficiencies: []
    };

    // YardÄ±mcÄ± Fonksiyonlar
    function generateId() {
      return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    function showToast(message) {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      
      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);
      
      setTimeout(() => toast.remove(), 3000);
    }

    function getTotalQuestions() {
      return Object.values(auditQuestions).reduce((sum, cat) => sum + cat.questions.length, 0);
    }

    function getAnsweredCount() {
      return Object.values(appState.answers).filter(a => a.value).length;
    }

    function updateProgress() {
      const total = getTotalQuestions();
      const answered = getAnsweredCount();
      const percentage = Math.round((answered / total) * 100);
      
      document.getElementById('progress-bar').style.width = percentage + '%';
      document.getElementById('progress-display').textContent = `${answered}/${total} Soru`;
    }

    // LocalStorage Ä°ÅŸlemleri
    function saveAuditsToStorage() {
      try {
        localStorage.setItem('isg_audits', JSON.stringify(appState.allAudits));
      } catch (e) {
        console.error('LocalStorage kayit hatasi:', e);
        showToast('Veri kaydetme hatasi!');
      }
    }

    function loadAuditsFromStorage() {
      try {
        const saved = localStorage.getItem('isg_audits');
        if (saved) {
          appState.allAudits = JSON.parse(saved);
        }
      } catch (e) {
        console.error('LocalStorage okuma hatasi:', e);
      }
    }

    // Sekme DeÄŸiÅŸtirme
    function switchTab(tab) {
      const existingWarnings = document.querySelectorAll('.unanswered-warning');
      existingWarnings.forEach(w => w.remove());
      
      document.getElementById('tab-new').classList.remove('active');
      document.getElementById('tab-data').classList.remove('active');
      document.getElementById('tab-info').classList.remove('active');
      document.getElementById('content-new').classList.add('hidden');
      document.getElementById('content-data').classList.add('hidden');
      document.getElementById('content-info').classList.add('hidden');
      
      document.getElementById(`tab-${tab}`).classList.add('active');
      document.getElementById(`content-${tab}`).classList.remove('hidden');

      if (tab === 'data') {
        renderStatistics();
        renderAuditHistory();
      }
    }

    // Ä°statistikleri GÃ¶ster
    function renderStatistics() {
      const container = document.getElementById('statistics-container');
      
      if (appState.allAudits.length === 0) {
        container.innerHTML = '<p class="col-span-full text-center text-gray-500 py-4">HenÃ¼z veri bulunmuyor</p>';
        return;
      }

      const totalAudits = appState.allAudits.length;
      let totalDeficiencies = 0;
      let totalCompliant = 0;
      let totalNA = 0;

      appState.allAudits.forEach(audit => {
        Object.values(audit.answers || {}).forEach(answer => {
          if (answer.value === 'no') totalDeficiencies++;
          else if (answer.value === 'yes') totalCompliant++;
          else if (answer.value === 'na') totalNA++;
        });
      });

      const stats = [
        { label: 'Toplam Denetim', value: totalAudits, color: 'blue', icon: 'ğŸ“Š' },
        { label: 'Toplam Uygun', value: totalCompliant, color: 'green', icon: 'âœ“' },
        { label: 'Toplam Eksiklik', value: totalDeficiencies, color: 'red', icon: 'âš ï¸' },
        { label: 'Gerekli DeÄŸil', value: totalNA, color: 'yellow', icon: 'â—¯' }
      ];

      container.innerHTML = stats.map(stat => {
        const colorClasses = {
          blue: 'bg-blue-50 border-blue-200 text-blue-600',
          green: 'bg-green-50 border-green-200 text-green-600',
          red: 'bg-red-50 border-red-200 text-red-600',
          yellow: 'bg-yellow-50 border-yellow-200 text-yellow-600'
        };

        return `
          <div class="${colorClasses[stat.color]} border rounded-2xl p-4 text-center">
            <div class="text-2xl mb-1">${stat.icon}</div>
            <div class="text-2xl font-bold">${stat.value}</div>
            <div class="text-xs mt-1 font-medium">${stat.label}</div>
          </div>
        `;
      }).join('');
    }

    // Ã–nceki Denetimleri Kontrol Et
    function checkPreviousAudits() {
      const schoolCode = document.getElementById('school-code').value.trim();
      const schoolName = document.getElementById('school-name').value.trim();
      
      if (!schoolCode || !schoolName) {
        document.getElementById('previous-audit-warning').classList.add('hidden');
        appState.previousDeficiencies = [];
        return;
      }

      const previousAudits = appState.allAudits.filter(a => {
        if (appState.editingAuditId && a.id === appState.editingAuditId) {
          return false;
        }
        return a.school_code === schoolCode || a.school_name === schoolName;
      });

      if (previousAudits.length === 0) {
        document.getElementById('previous-audit-warning').classList.add('hidden');
        appState.previousDeficiencies = [];
        return;
      }

      const latestAudit = previousAudits.sort((a, b) => 
        new Date(b.audit_date) - new Date(a.audit_date)
      )[0];

      const deficiencies = Object.entries(latestAudit.answers || {})
        .filter(([code, answer]) => answer.value === 'no')
        .map(([code, answer]) => ({
          code,
          dof: answer.dof,
          note: answer.note,
          photo: (latestAudit.photos || {})[code],
          resolved: false,
          fromAuditDate: latestAudit.audit_date
        }));

      if (deficiencies.length > 0) {
        appState.previousDeficiencies = deficiencies;
        document.getElementById('previous-audit-warning').classList.remove('hidden');
        
        const listContainer = document.getElementById('previous-deficiencies-list');
        listContainer.innerHTML = `
          <div class="bg-blue-50 p-2 rounded-lg border border-blue-300 text-xs mb-2">
            <span class="font-bold text-blue-800">ğŸ“… Son Denetim Tarihi: ${latestAudit.audit_date}</span>
          </div>
          ${deficiencies.map(d => `
            <div class="bg-white p-2 rounded-lg border border-orange-300 text-sm">
              <span class="font-bold text-orange-800">${d.code}:</span>
              <span class="text-orange-700">${d.dof}</span>
            </div>
          `).join('')}
        `;
      } else {
        document.getElementById('previous-audit-warning').classList.add('hidden');
        appState.previousDeficiencies = [];
      }
    }

    // Denetim GeÃ§miÅŸi
    function renderAuditHistory() {
      const container = document.getElementById('audit-history');
      
      if (appState.allAudits.length === 0) {
        container.innerHTML = `
          <div class="text-center py-12">
            <div class="text-6xl mb-4">ğŸ“‹</div>
            <p class="text-gray-500 font-medium">HenÃ¼z kayÄ±tlÄ± denetim bulunmuyor</p>
            <p class="text-gray-400 text-sm">Yeni bir denetim baÅŸlatarak kaydetmeye baÅŸlayÄ±n</p>
          </div>
        `;
        return;
      }

      const sortedAudits = [...appState.allAudits].sort((a, b) => 
        new Date(b.audit_date) - new Date(a.audit_date)
      );

      container.innerHTML = sortedAudits.map(audit => {
        const questionDefCount = Object.values(audit.answers || {}).filter(a => a.value === 'no').length;
        const otherDefCount = (audit.other_deficiencies || []).length;
        const defCount = questionDefCount + otherDefCount;
        const totalCount = Object.keys(audit.answers || {}).length;
        
        return `
          <div class="bg-white rounded-xl p-4 shadow hover:shadow-md transition border-l-4 ${defCount > 0 ? 'border-red-500' : 'border-green-500'}">
            <div class="flex items-start justify-between mb-2 cursor-pointer" onclick="viewAuditDetails('${audit.id}')">
              <div class="flex-1">
                <h3 class="font-bold text-gray-800">${audit.school_name}</h3>
                <p class="text-sm text-gray-500">Kod: ${audit.school_code}</p>
                ${audit.school_district ? `<p class="text-sm text-gray-500">Ä°lÃ§e: ${audit.school_district}</p>` : ''}
              </div>
              <div class="text-right">
                <p class="text-sm font-medium text-gray-600">${audit.audit_date}</p>
                <p class="text-xs text-gray-400 mt-1">${totalCount} soru</p>
              </div>
            </div>
            <div class="flex items-center gap-2 mt-3 cursor-pointer" onclick="viewAuditDetails('${audit.id}')">
              ${defCount > 0 ? 
                `<span class="px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded">âš ï¸ ${defCount} Eksiklik</span>` :
                `<span class="px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded">âœ“ Uygun</span>`
              }
              <span class="px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded">${audit.status === 'completed' ? 'TamamlandÄ±' : 'Devam Ediyor'}</span>
            </div>
            <div class="flex gap-2 mt-3">
              <button onclick="event.stopPropagation(); editAudit('${audit.id}')" 
                      class="flex-1 py-2 bg-blue-500 text-white text-sm font-medium rounded-lg hover:bg-blue-600 transition">
                âœï¸ DÃ¼zenle
              </button>
              <button onclick="event.stopPropagation(); downloadAuditPDF('${audit.id}')" 
                      class="flex-1 py-2 bg-green-500 text-white text-sm font-medium rounded-lg hover:bg-green-600 transition">
                ğŸ“„ PDF
              </button>
              <button onclick="event.stopPropagation(); deleteAuditFromList('${audit.id}')" 
                      class="flex-1 py-2 bg-red-500 text-white text-sm font-medium rounded-lg hover:bg-red-600 transition">
                ğŸ—‘ï¸ Sil
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function loadAudit(auditId) {
      const audit = appState.allAudits.find(a => a.id === auditId);
      if (!audit) return;

      document.getElementById('school-code').value = audit.school_code;
      document.getElementById('school-name').value = audit.school_name;
      document.getElementById('school-district').value = audit.school_district || '';
      document.getElementById('audit-date').value = audit.audit_date;
      document.getElementById('school-address').value = audit.school_address || '';
      document.getElementById('school-scope').value = audit.school_scope || '';
      document.getElementById('school-hazard-class').value = audit.school_hazard_class || '';
      document.getElementById('school-phone').value = audit.school_phone || '';
      document.getElementById('school-email').value = audit.school_email || '';

      document.getElementById('manager-count').value = audit.manager_count || 0;
      document.getElementById('teacher-count').value = audit.teacher_count || 0;
      document.getElementById('officer-count').value = audit.officer_count || 0;
      document.getElementById('servant-count').value = audit.servant_count || 0;
      document.getElementById('worker-count').value = audit.worker_count || 0;
      document.getElementById('typ-count').value = audit.typ_count || 0;
      document.getElementById('paid-teacher-count').value = audit.paid_teacher_count || 0;
      document.getElementById('contract-count').value = audit.contract_count || 0;
      document.getElementById('master-instructor-count').value = audit.master_instructor_count || 0;
      document.getElementById('disabled-count').value = audit.disabled_count || 0;
      document.getElementById('exconvict-count').value = audit.exconvict_count || 0;
      document.getElementById('chronic-count').value = audit.chronic_count || 0;
      calculateTotalPersonnel();

      document.getElementById('normal-student-count').value = audit.normal_student_count || 0;
      document.getElementById('disabled-student-count').value = audit.disabled_student_count || 0;
      document.getElementById('inclusion-student-count').value = audit.inclusion_student_count || 0;
      document.getElementById('chronic-student-count').value = audit.chronic_student_count || 0;
      calculateTotalStudents();

      appState.schoolCode = audit.school_code;
      appState.schoolName = audit.school_name;
      appState.schoolDistrict = audit.school_district || '';
      appState.auditDate = audit.audit_date;
      appState.schoolAddress = audit.school_address || '';
      appState.schoolScope = audit.school_scope || '';
      appState.schoolHazardClass = audit.school_hazard_class || '';
      appState.schoolPhone = audit.school_phone || '';
      appState.schoolEmail = audit.school_email || '';
      appState.managerCount = audit.manager_count || 0;
      appState.teacherCount = audit.teacher_count || 0;
      appState.officerCount = audit.officer_count || 0;
      appState.servantCount = audit.servant_count || 0;
      appState.workerCount = audit.worker_count || 0;
      appState.typCount = audit.typ_count || 0;
      appState.paidTeacherCount = audit.paid_teacher_count || 0;
      appState.contractCount = audit.contract_count || 0;
      appState.masterInstructorCount = audit.master_instructor_count || 0;
      appState.disabledCount = audit.disabled_count || 0;
      appState.exconvictCount = audit.exconvict_count || 0;
      appState.chronicCount = audit.chronic_count || 0;
      appState.totalPersonnel = audit.total_personnel || 0;
      appState.normalStudentCount = audit.normal_student_count || 0;
      appState.disabledStudentCount = audit.disabled_student_count || 0;
      appState.inclusionStudentCount = audit.inclusion_student_count || 0;
      appState.chronicStudentCount = audit.chronic_student_count || 0;
      appState.totalStudents = audit.total_students || 0;
      appState.answers = audit.answers || {};
      appState.photos = audit.photos || {};
      appState.editingAuditId = auditId;
      appState.previousDeficiencies = audit.previous_deficiencies || [];
      appState.otherDeficiencies = audit.other_deficiencies || [];
    }

    function viewAuditDetails(auditId) {
      const audit = appState.allAudits.find(a => a.id === auditId);
      if (!audit) return;

      const deficiencies = Object.entries(audit.answers || {})
        .filter(([code, answer]) => answer.value === 'no')
        .map(([code, answer]) => ({
          code,
          dof: answer.dof,
          note: answer.note,
          photo: (audit.photos || {})[code]
        }));

      const yesCount = Object.values(audit.answers || {}).filter(a => a.value === 'yes').length;
      const noCount = deficiencies.length;
      const naCount = Object.values(audit.answers || {}).filter(a => a.value === 'na').length;

      const detailContent = document.getElementById('detail-content');
      detailContent.innerHTML = `
        <div class="bg-white rounded-xl p-4 border">
          <h3 class="text-lg font-bold text-gray-800 mb-3">ğŸ“‹ Denetim Bilgileri</h3>
          <div class="grid grid-cols-2 gap-3 text-sm">
            <div><span class="text-gray-500">Okul:</span> <strong>${audit.school_name}</strong></div>
            <div><span class="text-gray-500">Kod:</span> <strong>${audit.school_code}</strong></div>
            <div><span class="text-gray-500">Ä°lÃ§e:</span> <strong>${audit.school_district || '-'}</strong></div>
            <div><span class="text-gray-500">Tarih:</span> <strong>${audit.audit_date}</strong></div>
            <div class="col-span-2"><span class="text-gray-500">Adres:</span> <strong>${audit.school_address || '-'}</strong></div>
            <div><span class="text-gray-500">Kapsam:</span> <strong>${audit.school_scope || '-'}</strong></div>
            <div><span class="text-gray-500">Tehlike SÄ±nÄ±fÄ±:</span> <strong>${audit.school_hazard_class || '-'}</strong></div>
            <div><span class="text-gray-500">Telefon:</span> <strong>${audit.school_phone || '-'}</strong></div>
            <div><span class="text-gray-500">E-Posta:</span> <strong>${audit.school_email || '-'}</strong></div>
            <div><span class="text-gray-500">Toplam Personel:</span> <strong>${audit.total_personnel || 0}</strong></div>
            <div><span class="text-gray-500">Toplam Ã–ÄŸrenci:</span> <strong>${audit.total_students || 0}</strong></div>
          </div>
        </div>

        <div class="grid grid-cols-3 gap-3">
          <div class="bg-green-50 border border-green-200 rounded-xl p-3 text-center">
            <div class="text-xl font-bold text-green-600">${yesCount}</div>
            <div class="text-xs text-green-700">Evet</div>
          </div>
          <div class="bg-red-50 border border-red-200 rounded-xl p-3 text-center">
            <div class="text-xl font-bold text-red-600">${noCount}</div>
            <div class="text-xs text-red-700">HayÄ±r</div>
          </div>
          <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-3 text-center">
            <div class="text-xl font-bold text-yellow-600">${naCount}</div>
            <div class="text-xs text-yellow-700">Gerekli DeÄŸil</div>
          </div>
        </div>

        <div>
          ${deficiencies.length > 0 || (audit.other_deficiencies || []).length > 0 ? `
            <div class="bg-white rounded-xl border p-4">
              <h3 class="text-lg font-bold text-red-600 mb-3">âš ï¸ DÃ¼zeltici Ã–nleyici Faaliyetler (${deficiencies.length + (audit.other_deficiencies || []).length})</h3>
              <div class="space-y-3">
                ${deficiencies.map(d => {
                  const isPrevious = (audit.previous_deficiencies || []).find(pd => pd.code === d.code && !pd.resolved);
                  return `
                    <div class="p-3 bg-red-50 border border-red-200 rounded-lg">
                      <div class="flex items-start gap-2 mb-2">
                        <span class="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">${d.code}</span>
                        ${isPrevious ? '<span class="bg-orange-500 text-white text-xs px-2 py-1 rounded">(Devam Eden)</span>' : ''}
                      </div>
                      <p class="text-red-800 font-medium mb-1">${d.dof}</p>
                      ${d.note ? `<p class="text-red-600 text-sm">Not: ${d.note}</p>` : ''}
                      ${d.photo ? `<img src="${d.photo}" alt="Deficiency photo" loading="lazy" class="w-full h-32 object-cover rounded-lg mt-2">` : ''}
                    </div>
                  `;
                }).join('')}
                ${(audit.other_deficiencies || []).length > 0 ? `
                  <div class="border-t-2 border-purple-300 pt-3 mt-3">
                    <h4 class="text-sm font-bold text-purple-700 mb-2">ğŸ“ DiÄŸer DÃ–F (${(audit.other_deficiencies || []).length})</h4>
                    ${(audit.other_deficiencies || []).map((dof, idx) => `
                      <div class="p-3 bg-purple-50 border border-purple-200 rounded-lg mb-2">
                        <div class="flex items-start gap-2 mb-2">
                          <span class="bg-purple-500 text-white text-xs font-bold px-2 py-1 rounded">DÄ°ÄER ${idx + 1}</span>
                        </div>
                        <p class="text-purple-900 font-medium">${dof}</p>
                      </div>
                    `).join('')}
                  </div>
                ` : ''}
              </div>
            </div>
          ` : `
            <div class="bg-green-50 border border-green-200 rounded-xl p-6 text-center">
              <div class="text-4xl mb-2">âœ…</div>
              <h3 class="text-lg font-bold text-green-700">Tebrikler!</h3>
              <p class="text-green-600">TÃ¼m maddeler uygun bulunmuÅŸtur.</p>
            </div>
          `}
        </div>
      `;

      const detailActions = document.getElementById('detail-actions-modal');
      detailActions.innerHTML = `
        <button onclick="editAudit('${auditId}')" class="w-full py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold rounded-xl hover:shadow-lg transition">
          âœï¸ Denetimi DÃ¼zenle
        </button>
        <button onclick="downloadAuditPDF('${auditId}')" class="w-full py-3 bg-gradient-to-r from-green-500 to-green-700 text-white font-semibold rounded-xl hover:shadow-lg transition">
          ğŸ“„ PDF Ä°ndir
        </button>
        <button onclick="deleteAudit('${auditId}')" class="w-full py-3 bg-gradient-to-r from-red-500 to-red-700 text-white font-semibold rounded-xl hover:shadow-lg transition">
          ğŸ—‘ï¸ Denetimi Sil
        </button>
      `;

      document.getElementById('detail-modal').classList.remove('hidden');
    }

    function closeDetailModal() {
      document.getElementById('detail-modal').classList.add('hidden');
    }

    function editAudit(auditId) {
      closeDetailModal();
      loadAudit(auditId);
      switchTab('new');
    }

    function deleteAuditFromList(auditId) {
      const deleteBtn = event.target;
      
      if (deleteBtn.textContent.includes('ğŸ—‘ï¸ Sil')) {
        deleteBtn.textContent = 'âš ï¸ Emin misiniz?';
        deleteBtn.className = 'flex-1 py-2 bg-orange-500 text-white text-sm font-medium rounded-lg hover:bg-orange-600 transition';
        
        setTimeout(() => {
          deleteBtn.textContent = 'ğŸ—‘ï¸ Sil';
          deleteBtn.className = 'flex-1 py-2 bg-red-500 text-white text-sm font-medium rounded-lg hover:bg-red-600 transition';
        }, 3000);
        return;
      }
      
      appState.allAudits = appState.allAudits.filter(a => a.id !== auditId);
      saveAuditsToStorage();
      renderAuditHistory();
      renderStatistics();
      showToast('Denetim silindi');
    }

    function deleteAudit(auditId) {
      const deleteBtn = event.target;
      
      if (deleteBtn.textContent.includes('Denetimi Sil')) {
        deleteBtn.textContent = 'âš ï¸ Silmek iÃ§in tekrar tÄ±klayÄ±n';
        deleteBtn.className = 'w-full py-3 bg-gradient-to-r from-orange-500 to-orange-700 text-white font-semibold rounded-xl hover:shadow-lg transition';
        
        setTimeout(() => {
          deleteBtn.textContent = 'ğŸ—‘ï¸ Denetimi Sil';
          deleteBtn.className = 'w-full py-3 bg-gradient-to-r from-red-500 to-red-700 text-white font-semibold rounded-xl hover:shadow-lg transition';
        }, 3000);
        return;
      }
      
      appState.allAudits = appState.allAudits.filter(a => a.id !== auditId);
      saveAuditsToStorage();
      renderAuditHistory();
      closeDetailModal();
      showToast('Denetim silindi');
    }

    function downloadAuditPDF(auditId) {
      const audit = appState.allAudits.find(a => a.id === auditId);
      if (!audit) return;

      appState.schoolCode = audit.school_code;
      appState.schoolName = audit.school_name;
      appState.schoolDistrict = audit.school_district || '';
      appState.auditDate = audit.audit_date;
      appState.answers = audit.answers || {};
      appState.photos = audit.photos || {};
      
      downloadPDF();
    }

    // Sayfa GÃ¶ster
    function showPage(page) {
      const existingWarnings = document.querySelectorAll('.unanswered-warning');
      existingWarnings.forEach(w => w.remove());
      
      document.getElementById('home-page').classList.add('hidden');
      document.getElementById('personnel-page').classList.add('hidden');
      document.getElementById('audit-page').classList.add('hidden');
      document.getElementById('summary-page').classList.add('hidden');
      
      document.getElementById(`${page}-page`).classList.remove('hidden');
      appState.currentPage = page;
      
      if (page === 'audit') {
        setTimeout(() => {
          const auditPage = document.getElementById('audit-page');
          auditPage.scrollTop = 0;
        }, 50);
      } else {
        window.scrollTo(0, 0);
      }
    }

    // Personel SayÄ±sÄ± Hesaplama
    function calculateTotalPersonnel() {
      const managerCount = parseInt(document.getElementById('manager-count').value) || 0;
      const teacherCount = parseInt(document.getElementById('teacher-count').value) || 0;
      const officerCount = parseInt(document.getElementById('officer-count').value) || 0;
      const servantCount = parseInt(document.getElementById('servant-count').value) || 0;
      const workerCount = parseInt(document.getElementById('worker-count').value) || 0;
      const typCount = parseInt(document.getElementById('typ-count').value) || 0;
      const paidTeacherCount = parseInt(document.getElementById('paid-teacher-count').value) || 0;
      const contractCount = parseInt(document.getElementById('contract-count').value) || 0;
      const masterInstructorCount = parseInt(document.getElementById('master-instructor-count').value) || 0;
      const disabledCount = parseInt(document.getElementById('disabled-count').value) || 0;
      const exconvictCount = parseInt(document.getElementById('exconvict-count').value) || 0;
      const chronicCount = parseInt(document.getElementById('chronic-count').value) || 0;

      const total = managerCount + teacherCount + officerCount + servantCount + workerCount + 
                    typCount + paidTeacherCount + contractCount + masterInstructorCount + 
                    disabledCount + exconvictCount + chronicCount;

      document.getElementById('total-personnel').value = total;
    }

    // Ã–ÄŸrenci SayÄ±sÄ± Hesaplama
    function calculateTotalStudents() {
      const normalCount = parseInt(document.getElementById('normal-student-count').value) || 0;
      const disabledCount = parseInt(document.getElementById('disabled-student-count').value) || 0;
      const inclusionCount = parseInt(document.getElementById('inclusion-student-count').value) || 0;
      const chronicCount = parseInt(document.getElementById('chronic-student-count').value) || 0;

      const total = normalCount + disabledCount + inclusionCount + chronicCount;

      document.getElementById('total-students').value = total;
    }

    // Kategori Render Et
    function renderCurrentCategory() {
      const existingWarnings = document.querySelectorAll('.unanswered-warning');
      existingWarnings.forEach(w => w.remove());
      
      const catKey = categoryOrder[appState.currentCategoryIndex];
      const category = auditQuestions[catKey];
      
      document.getElementById('category-title').textContent = category.title;
      document.getElementById('school-info-display').textContent = 
        `${appState.schoolName} â€¢ ${appState.schoolDistrict} â€¢ ${appState.auditDate}`;

      let totalYesCount = 0, totalNoCount = 0, totalNaCount = 0;
      Object.values(appState.answers).forEach(answer => {
        if (answer.value === 'yes') totalYesCount++;
        else if (answer.value === 'no') totalNoCount++;
        else if (answer.value === 'na') totalNaCount++;
      });

      const statsContainer = document.getElementById('total-stats');
      statsContainer.innerHTML = `
        <div class="bg-green-50 border border-green-200 rounded-lg px-3 py-2 text-center">
          <div class="text-sm font-bold text-green-600">${totalYesCount}</div>
          <div class="text-xs text-green-700">Evet</div>
        </div>
        <div class="bg-red-50 border border-red-200 rounded-lg px-3 py-2 text-center">
          <div class="text-sm font-bold text-red-600">${totalNoCount}</div>
          <div class="text-xs text-red-700">HayÄ±r</div>
        </div>
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg px-3 py-2 text-center">
          <div class="text-sm font-bold text-yellow-600">${totalNaCount}</div>
          <div class="text-xs text-yellow-700">Gerekli DeÄŸil</div>
        </div>
      `;

      const container = document.getElementById('questions-container');
      container.innerHTML = '';

      category.questions.forEach((q, idx) => {
        const answer = appState.answers[q.code] || {};
        const hasPreviousDof = appState.previousDeficiencies.find(d => d.code === q.code && !d.resolved);
        
        if (hasPreviousDof && !answer.value) {
          appState.answers[q.code] = {
            value: 'no',
            dof: hasPreviousDof.dof || q.dof,
            note: hasPreviousDof.note || '',
            fromPreviousAudit: true
          };
          if (hasPreviousDof.photo) {
            appState.photos[q.code] = hasPreviousDof.photo;
          }
        }
        
        const currentAnswer = appState.answers[q.code] || {};
        
        const questionCard = document.createElement('div');
        let cardClasses = 'question-card p-4';
        if (currentAnswer.value === 'yes') cardClasses += ' answer-yes';
        else if (currentAnswer.value === 'no') cardClasses += ' answer-no';
        else if (currentAnswer.value === 'na') cardClasses += ' answer-na';
        questionCard.className = cardClasses;
        questionCard.innerHTML = `
          ${hasPreviousDof ? `
            <div class="text-white text-xs font-medium px-3 py-1 rounded-full inline-block mb-2 border-4 border-red-400" style="background: linear-gradient(135deg, #fca5a5, #ef4444);">
              âš ï¸ Ã–nceki denetimden devam eden eksiklik
            </div>
          ` : ''}
          <div class="mb-3">
            <p class="text-gray-800 font-medium text-lg">${q.code}. ${q.text}</p>
          </div>
          
          <div class="flex gap-2 mb-3">
            <button class="btn-answer btn-yes flex-1 py-2 rounded-lg font-medium ${currentAnswer.value === 'yes' ? 'selected' : ''}" 
                    onclick="setAnswer('${q.code}', 'yes', '${q.dof.replace(/'/g, "\\'")}')">
              âœ“ Evet
            </button>
            <button class="btn-answer btn-no flex-1 py-2 rounded-lg font-medium ${currentAnswer.value === 'no' ? 'selected' : ''}"
                    onclick="setAnswer('${q.code}', 'no', '${q.dof.replace(/'/g, "\\'")}')">
              âœ— HayÄ±r
            </button>
            <button class="btn-answer btn-na flex-1 py-2 rounded-lg font-medium ${currentAnswer.value === 'na' ? 'selected' : ''}"
                    onclick="setAnswer('${q.code}', 'na', '${q.dof.replace(/'/g, "\\'")}')">
              â—¯ Gerekli DeÄŸil
            </button>
          </div>
          
          <div id="extra-${q.code}" class="${currentAnswer.value ? '' : 'hidden'}">
            ${currentAnswer.value === 'no' ? `
              <div class="mb-3">
                <label for="dof-${q.code}" class="block text-sm font-medium text-gray-600 mb-1">DÃ–F Metni</label>
                <div class="flex gap-2">
                  <input type="text" id="dof-${q.code}" value="${currentAnswer.dof || q.dof}" 
                         class="flex-1 px-3 py-2 border border-red-200 rounded-lg text-sm focus:ring-2 focus:ring-red-500 outline-none"
                         oninput="markDofEdited('${q.code}')">
                  <button id="save-dof-${q.code}" class="hidden px-3 py-2 bg-red-500 text-white rounded-lg text-sm hover:bg-red-600 transition"
                          onclick="saveDof('${q.code}')">
                    Kaydet
                  </button>
                </div>
              </div>
              <button class="w-full py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 transition mb-3"
                      onclick="openPhotoModal('${q.code}')">
                ğŸ“· FotoÄŸraf Ã‡ek / Resim YÃ¼kle
              </button>
              ${appState.photos[q.code] ? `
                <div class="mb-3 relative">
                  <img src="${appState.photos[q.code]}" alt="Question photo" loading="lazy" class="w-full h-32 object-cover rounded-lg">
                  <button onclick="removePhoto('${q.code}')" 
                          class="absolute top-2 right-2 bg-red-500 text-white w-8 h-8 rounded-full hover:bg-red-600 transition shadow-lg font-bold">
                    âœ•
                  </button>
                </div>
              ` : ''}
            ` : ''}
            
            <div>
              <label for="note-${q.code}" class="block text-sm font-medium text-gray-600 mb-1">AÃ§Ä±klama (max 20 karakter)</label>
              <input type="text" id="note-${q.code}" 
                     value="${currentAnswer.note || (currentAnswer.value === 'na' ? 'Gerekli DeÄŸil' : '')}" 
                     maxlength="20"
                     class="w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                     placeholder="AÃ§Ä±klama ekleyin..."
                     onchange="saveNote('${q.code}')">
            </div>
          </div>
        `;
        
        container.appendChild(questionCard);
      });

      updateProgress();
      updateNavButtons();
    }

    // Cevap Kaydet
    function setAnswer(code, value, dof) {
      const prevAnswer = appState.answers[code] || {};
      
      appState.answers[code] = {
        value: value,
        dof: value === 'no' ? (prevAnswer.dof || dof) : '',
        note: value === 'na' ? 'Gerekli DeÄŸil' : ''
      };

      const prevDef = appState.previousDeficiencies.find(d => d.code === code);
      if (prevDef && value === 'yes') {
        prevDef.resolved = true;
      }

      saveTempAudit();
      renderCurrentCategory();
    }

    // DÃ–F DÃ¼zenleme
    function markDofEdited(code) {
      document.getElementById(`save-dof-${code}`).classList.remove('hidden');
    }

    function saveDof(code) {
      const dofInput = document.getElementById(`dof-${code}`);
      if (appState.answers[code]) {
        appState.answers[code].dof = dofInput.value;
      }
      document.getElementById(`save-dof-${code}`).classList.add('hidden');
      saveTempAudit();
      showToast('DÃ–F metni kaydedildi');
    }

    // Not Kaydet
    function saveNote(code) {
      const noteInput = document.getElementById(`note-${code}`);
      if (appState.answers[code]) {
        let note = noteInput.value;
        if (appState.answers[code].value === 'na' && note && !note.startsWith('Gerekli DeÄŸil')) {
          note = 'Gerekli DeÄŸil, ' + note;
          noteInput.value = note.substring(0, 20);
        }
        appState.answers[code].note = noteInput.value;
      }
      saveTempAudit();
    }

    // FotoÄŸraf Ä°ÅŸlemleri
    function openPhotoModal(code) {
      appState.currentPhotoQuestion = code;
      document.getElementById('photo-modal').classList.remove('hidden');
      document.getElementById('photo-preview-container').classList.add('hidden');
    }

    function closePhotoModal() {
      document.getElementById('photo-modal').classList.add('hidden');
      appState.currentPhotoQuestion = null;
    }

    function handlePhotoSelect(file) {
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const img = new Image();
        img.onload = function() {
          const canvas = document.createElement('canvas');
          let width = img.width;
          let height = img.height;
          
          const maxWidth = 600;
          if (width > maxWidth) {
            height = (height * maxWidth) / width;
            width = maxWidth;
          }
          
          canvas.width = width;
          canvas.height = height;
          
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0, width, height);
          
          const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.4);
          
          if (compressedDataUrl.length > 150000) {
            const smallerWidth = 500;
            const smallerHeight = (height * smallerWidth) / width;
            canvas.width = smallerWidth;
            canvas.height = smallerHeight;
            ctx.drawImage(img, 0, 0, smallerWidth, smallerHeight);
            const finalDataUrl = canvas.toDataURL('image/jpeg', 0.3);
            document.getElementById('photo-preview').src = finalDataUrl;
          } else {
            document.getElementById('photo-preview').src = compressedDataUrl;
          }
          
          document.getElementById('photo-preview-container').classList.remove('hidden');
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    function savePhotoFunc() {
      const preview = document.getElementById('photo-preview');
      if (preview.src && appState.currentPhotoQuestion) {
        appState.photos[appState.currentPhotoQuestion] = preview.src;
        saveTempAudit();
        showToast('FotoÄŸraf kaydedildi');
        closePhotoModal();
        renderCurrentCategory();
      }
    }

    function removePhoto(code) {
      delete appState.photos[code];
      saveTempAudit();
      renderCurrentCategory();
    }

    // Navigasyon
    function updateNavButtons() {
      const prevBtn = document.getElementById('prev-category');
      prevBtn.disabled = false;
      
      const isLastCategory = appState.currentCategoryIndex === categoryOrder.length - 1;
      const nextBtn = document.getElementById('next-category');
      nextBtn.textContent = isLastCategory ? 'Raporu Ã–nizle â†’' : 'Sonraki â†’';
    }

    function goToPrevCategory() {
      if (appState.currentCategoryIndex > 0) {
        appState.currentCategoryIndex--;
        saveTempAudit();
        renderCurrentCategory();
        setTimeout(() => {
          const auditPage = document.getElementById('audit-page');
          auditPage.scrollTop = 0;
        }, 50);
      } else {
        saveTempAudit();
        showPage('personnel');
      }
    }

    function goToNextCategory() {
      const catKey = categoryOrder[appState.currentCategoryIndex];
      const category = auditQuestions[catKey];
      
      const unansweredQuestion = category.questions.find(q => !appState.answers[q.code] || !appState.answers[q.code].value);
      
      if (unansweredQuestion) {
        const existingWarnings = document.querySelectorAll('.unanswered-warning');
        existingWarnings.forEach(w => w.remove());
        
        setTimeout(() => {
          const questionElements = document.querySelectorAll('.question-card');
          const questionIndex = category.questions.findIndex(q => q.code === unansweredQuestion.code);
          if (questionElements[questionIndex]) {
            questionElements[questionIndex].scrollIntoView({ 
              behavior: 'smooth', 
              block: 'center' 
            });
            
            const warning = document.createElement('div');
            warning.className = 'unanswered-warning';
            warning.textContent = 'âš ï¸ LÃ¼tfen tÃ¼m sorularÄ± cevaplayÄ±n';
            
            const cardParent = questionElements[questionIndex].parentElement;
            const originalPosition = cardParent.style.position;
            cardParent.style.position = 'relative';
            
            warning.style.top = (questionElements[questionIndex].offsetTop - 2 - 48) + 'px';
            cardParent.appendChild(warning);
            
            setTimeout(() => {
              warning.remove();
              cardParent.style.position = originalPosition;
            }, 3000);
            
            questionElements[questionIndex].classList.add('blink-border');
            setTimeout(() => {
              questionElements[questionIndex].classList.remove('blink-border');
            }, 2000);
          }
        }, 100);
        return;
      }

      if (appState.currentCategoryIndex < categoryOrder.length - 1) {
        appState.currentCategoryIndex++;
        saveTempAudit();
        renderCurrentCategory();
        setTimeout(() => {
          const auditPage = document.getElementById('audit-page');
          auditPage.scrollTop = 0;
        }, 50);
      } else {
        showSummary();
      }
    }

    // Ã–zet GÃ¶ster
    function showSummary() {
      showPage('summary');
      renderSummary();
      renderOtherDofList();
    }

    // DiÄŸer DÃ–F Listesi
    function renderOtherDofList() {
      const listContainer = document.getElementById('other-dof-list');
      
      if (appState.otherDeficiencies.length === 0) {
        listContainer.innerHTML = '';
        return;
      }

      listContainer.innerHTML = appState.otherDeficiencies.map((dof, index) => `
        <div class="p-3 bg-white border border-purple-300 rounded-xl flex items-start gap-3">
          <div class="flex-1">
            <p class="text-purple-900 font-medium">${dof}</p>
          </div>
          <button onclick="removeOtherDof(${index})" 
                  class="text-red-500 hover:text-red-700 font-bold text-xl">
            âœ•
          </button>
        </div>
      `).join('');
    }

    // DiÄŸer DÃ–F Ekle
    function addOtherDof() {
      const input = document.getElementById('other-dof-text');
      const dofText = input.value.trim();
      
      if (!dofText) {
        showToast('LÃ¼tfen DÃ–F metnini girin');
        return;
      }

      appState.otherDeficiencies.push(dofText);
      input.value = '';
      saveTempAudit();
      renderOtherDofList();
      renderSummary();
      showToast('DiÄŸer DÃ–F eklendi');
    }

    // DiÄŸer DÃ–F Sil
    function removeOtherDof(index) {
      appState.otherDeficiencies.splice(index, 1);
      saveTempAudit();
      renderOtherDofList();
      renderSummary();
      showToast('DiÄŸer DÃ–F silindi');
    }
    
    // Formu Temizle
    function resetForm() {
      appState.answers = {};
      appState.photos = {};
      appState.currentCategoryIndex = 0;
      appState.editingAuditId = null;
      appState.previousDeficiencies = [];
      
      document.getElementById('previous-audit-warning').classList.add('hidden');
    }
    
    function clearAllForm() {
      document.getElementById('school-code').value = '';
      document.getElementById('school-name').value = '';
      document.getElementById('school-district').value = '';
      document.getElementById('audit-date').valueAsDate = new Date();
      document.getElementById('school-address').value = '';
      document.getElementById('school-scope').value = '';
      document.getElementById('school-hazard-class').value = '';
      document.getElementById('school-phone').value = '';
      document.getElementById('school-email').value = '';
      appState.schoolCode = '';
      appState.schoolName = '';
      appState.schoolDistrict = '';
      appState.auditDate = '';
      appState.schoolAddress = '';
      appState.schoolScope = '';
      appState.schoolHazardClass = '';
      appState.schoolPhone = '';
      appState.schoolEmail = '';
      appState.answers = {};
      appState.photos = {};
      appState.currentCategoryIndex = 0;
      appState.editingAuditId = null;
      appState.previousDeficiencies = [];
      
      document.getElementById('previous-audit-warning').classList.add('hidden');
    }

    function renderSummary() {
      const content = document.getElementById('summary-content');
      
      let yesCount = 0, noCount = 0, naCount = 0;
      const deficiencies = [];
      const continuingDeficiencies = [];
      const newDeficiencies = [];
      const resolvedDeficiencies = [];
      
      Object.entries(appState.answers).forEach(([code, answer]) => {
        if (answer.value === 'yes') {
          yesCount++;
          const wasPrevious = appState.previousDeficiencies.find(pd => pd.code === code);
          if (wasPrevious) {
            wasPrevious.resolved = true;
            resolvedDeficiencies.push({ code, dof: wasPrevious.dof });
          }
        }
        else if (answer.value === 'no') {
          noCount++;
          const photo = appState.photos[code] || null;
          const isPrevious = appState.previousDeficiencies.find(pd => pd.code === code && !pd.resolved);
          
          if (isPrevious) {
            continuingDeficiencies.push({ code, dof: answer.dof, note: answer.note, photo });
          } else {
            newDeficiencies.push({ code, dof: answer.dof, note: answer.note, photo });
          }
          
          deficiencies.push({ code, dof: answer.dof, note: answer.note, photo, isPrevious: !!isPrevious });
        }
        else if (answer.value === 'na') naCount++;
      });

      content.innerHTML = `
        <div class="bg-white rounded-2xl shadow-lg p-6">
          <h3 class="text-lg font-bold text-gray-800 mb-4">ğŸ“‹ Denetim Bilgileri</h3>
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div><span class="text-gray-500">Okul:</span> <strong>${appState.schoolName}</strong></div>
            <div><span class="text-gray-500">Kod:</span> <strong>${appState.schoolCode}</strong></div>
            <div><span class="text-gray-500">Ä°lÃ§e:</span> <strong>${appState.schoolDistrict || '-'}</strong></div>
            <div><span class="text-gray-500">Tarih:</span> <strong>${appState.auditDate}</strong></div>
            <div class="col-span-2"><span class="text-gray-500">Adres:</span> <strong>${appState.schoolAddress || '-'}</strong></div>
            <div><span class="text-gray-500">Kapsam:</span> <strong>${appState.schoolScope || '-'}</strong></div>
            <div><span class="text-gray-500">Tehlike SÄ±nÄ±fÄ±:</span> <strong>${appState.schoolHazardClass || '-'}</strong></div>
            <div><span class="text-gray-500">Telefon:</span> <strong>${appState.schoolPhone || '-'}</strong></div>
            <div><span class="text-gray-500">E-Posta:</span> <strong>${appState.schoolEmail || '-'}</strong></div>
            <div><span class="text-gray-500">Toplam Personel:</span> <strong>${appState.totalPersonnel}</strong></div>
            <div><span class="text-gray-500">Toplam Ã–ÄŸrenci:</span> <strong>${appState.totalStudents}</strong></div>
            <div><span class="text-gray-500">Toplam Soru:</span> <strong>${getTotalQuestions()}</strong></div>
          </div>
        </div>
        
        <div class="grid grid-cols-3 gap-3">
          <div class="bg-green-50 border border-green-200 rounded-xl p-4 text-center">
            <div class="text-2xl font-bold text-green-600">${yesCount}</div>
            <div class="text-xs text-green-700">Evet</div>
          </div>
          <div class="bg-red-50 border border-red-200 rounded-xl p-4 text-center">
            <div class="text-2xl font-bold text-red-600">${noCount}</div>
            <div class="text-xs text-red-700">HayÄ±r</div>
          </div>
          <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-center">
            <div class="text-2xl font-bold text-yellow-600">${naCount}</div>
            <div class="text-xs text-yellow-700">Gerekli DeÄŸil</div>
          </div>
        </div>

        ${appState.previousDeficiencies.length > 0 ? `
          <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl shadow-lg p-6 border border-blue-200">
            <h3 class="text-lg font-bold text-blue-800 mb-3">ğŸ“Š Ã–nceki Denetim Takibi</h3>
            <div class="grid grid-cols-3 gap-3 mb-4">
              <div class="bg-white rounded-lg p-3 text-center border border-blue-200">
                <div class="text-xl font-bold text-orange-600">${continuingDeficiencies.length}</div>
                <div class="text-xs text-gray-600">Devam Eden</div>
              </div>
              <div class="bg-white rounded-lg p-3 text-center border border-blue-200">
                <div class="text-xl font-bold text-green-600">${resolvedDeficiencies.length}</div>
                <div class="text-xs text-gray-600">Giderildi</div>
              </div>
              <div class="bg-white rounded-lg p-3 text-center border border-blue-200">
                <div class="text-xl font-bold text-red-600">${newDeficiencies.length}</div>
                <div class="text-xs text-gray-600">Yeni Eksiklik</div>
              </div>
            </div>
            ${resolvedDeficiencies.length > 0 ? `
              <div class="bg-green-50 border border-green-300 rounded-lg p-3 mb-3">
                <h4 class="text-sm font-bold text-green-800 mb-2">âœ… Giderilen Eksiklikler</h4>
                <div class="space-y-1">
                  ${resolvedDeficiencies.map(d => `
                    <div class="text-xs text-green-700">â€¢ ${d.code}: ${d.dof}</div>
                  `).join('')}
                </div>
              </div>
            ` : ''}
          </div>
        ` : ''}
        
        ${deficiencies.length > 0 ? `
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-lg font-bold text-red-600 mb-4">âš ï¸ DÃ¼zeltici Ã–nleyici Faaliyetler (${deficiencies.length})</h3>
            
            ${continuingDeficiencies.length > 0 ? `
              <div class="mb-4">
                <h4 class="text-sm font-bold text-orange-600 mb-2">ğŸ”„ Ã–nceki Denetimden Devam Eden Eksiklikler (${continuingDeficiencies.length})</h4>
                <div class="space-y-3">
                  ${continuingDeficiencies.map(d => `
                    <div class="p-3 bg-orange-50 border-2 border-orange-300 rounded-xl">
                      <div class="flex items-start gap-2 mb-2">
                        <span class="bg-orange-500 text-white text-xs font-bold px-2 py-1 rounded">${d.code}</span>
                        <span class="bg-red-500 text-white text-xs px-2 py-1 rounded">âš ï¸ DEVAM EDÄ°YOR</span>
                      </div>
                      <p class="text-orange-900 font-medium">${d.dof}</p>
                      ${d.note ? `<p class="text-orange-700 text-sm mt-1">Not: ${d.note}</p>` : ''}
                      ${d.photo ? `<img src="${d.photo}" alt="Deficiency photo" loading="lazy" class="w-full h-24 object-cover rounded-lg mt-2">` : ''}
                    </div>
                  `).join('')}
                </div>
              </div>
            ` : ''}

            ${newDeficiencies.length > 0 ? `
              <div>
                <h4 class="text-sm font-bold text-red-600 mb-2">ğŸ†• Yeni Tespit Edilen Eksiklikler (${newDeficiencies.length})</h4>
                <div class="space-y-3">
                  ${newDeficiencies.map(d => `
                    <div class="p-3 bg-red-50 border border-red-200 rounded-xl">
                      <div class="flex items-start gap-2 mb-2">
                        <span class="bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">${d.code}</span>
                      </div>
                      <p class="text-red-800 font-medium">${d.dof}</p>
                      ${d.note ? `<p class="text-red-600 text-sm mt-1">Not: ${d.note}</p>` : ''}
                      ${d.photo ? `<img src="${d.photo}" alt="Deficiency photo" loading="lazy" class="w-full h-24 object-cover rounded-lg mt-2">` : ''}
                    </div>
                  `).join('')}
                </div>
              </div>
            ` : ''}
          </div>
        ` : `
          <div class="bg-green-50 border border-green-200 rounded-2xl p-6 text-center">
            <div class="text-4xl mb-2">âœ…</div>
            <h3 class="text-lg font-bold text-green-700">Tebrikler!</h3>
            <p class="text-green-600">TÃ¼m maddeler uygun bulunmuÅŸtur.</p>
          </div>
        `}

        ${(() => {
          const otherDofs = appState.otherDeficiencies || [];
          if (otherDofs.length === 0) return '';
          
          return `
            <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl shadow-lg p-6 border border-purple-300">
              <h3 class="text-lg font-bold text-purple-900 mb-4">ğŸ“ DiÄŸer DÃ–F (${otherDofs.length})</h3>
              <div class="space-y-3">
                ${otherDofs.map((dof, idx) => `
                  <div class="p-3 bg-white border border-purple-200 rounded-xl">
                    <div class="flex items-start gap-2 mb-2">
                      <span class="bg-purple-500 text-white text-xs font-bold px-2 py-1 rounded">DÄ°ÄER ${idx + 1}</span>
                    </div>
                    <p class="text-purple-900 font-medium">${dof}</p>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        })()}
      `;
    }

    // Denetimi Kaydet

async function saveAudit() {
  const saveBtn = document.getElementById('save-audit');
  saveBtn.disabled = true;
  saveBtn.textContent = 'â³ Kaydediliyor...';

  try {
    const filteredPhotos = {};
    Object.keys(appState.photos).forEach(code => {
      if (appState.answers[code] && appState.answers[code].value === 'no') {
        filteredPhotos[code] = appState.photos[code];
      }
    });

    let newAudit;

    if (appState.editingAuditId) {
      const auditIndex = appState.allAudits.findIndex(a => a.id === appState.editingAuditId);
      if (auditIndex !== -1) {
        appState.allAudits[auditIndex] = {
          ...appState.allAudits[auditIndex],
          school_name: appState.schoolName,
          school_code: appState.schoolCode,
          school_district: appState.schoolDistrict,
          audit_date: appState.auditDate,
          school_address: appState.schoolAddress,
          school_scope: appState.schoolScope,
          school_hazard_class: appState.schoolHazardClass,
          school_phone: appState.schoolPhone,
          school_email: appState.schoolEmail,
          manager_count: appState.managerCount,
          teacher_count: appState.teacherCount,
          officer_count: appState.officerCount,
          servant_count: appState.servantCount,
          worker_count: appState.workerCount,
          typ_count: appState.typCount,
          paid_teacher_count: appState.paidTeacherCount,
          contract_count: appState.contractCount,
          master_instructor_count: appState.masterInstructorCount,
          disabled_count: appState.disabledCount,
          exconvict_count: appState.exconvictCount,
          chronic_count: appState.chronicCount,
          total_personnel: appState.totalPersonnel,
          normal_student_count: appState.normalStudentCount,
          disabled_student_count: appState.disabledStudentCount,
          inclusion_student_count: appState.inclusionStudentCount,
          chronic_student_count: appState.chronicStudentCount,
          total_students: appState.totalStudents,
          answers: appState.answers,
          photos: filteredPhotos,
          previous_deficiencies: appState.previousDeficiencies,
          other_deficiencies: appState.otherDeficiencies,
          status: 'completed',
          updated_at: new Date().toISOString()
        };
        newAudit = appState.allAudits[auditIndex];
      }
    } else {
      newAudit = {
        id: generateId(),
        school_code: appState.schoolCode,
        school_name: appState.schoolName,
        school_district: appState.schoolDistrict,
        audit_date: appState.auditDate,
        school_address: appState.schoolAddress,
        school_scope: appState.schoolScope,
        school_hazard_class: appState.schoolHazardClass,
        school_phone: appState.schoolPhone,
        school_email: appState.schoolEmail,
        manager_count: appState.managerCount,
        teacher_count: appState.teacherCount,
        officer_count: appState.officerCount,
        servant_count: appState.servantCount,
        worker_count: appState.workerCount,
        typ_count: appState.typCount,
        paid_teacher_count: appState.paidTeacherCount,
        contract_count: appState.contractCount,
        master_instructor_count: appState.masterInstructorCount,
        disabled_count: appState.disabledCount,
        exconvict_count: appState.exconvictCount,
        chronic_count: appState.chronicCount,
        total_personnel: appState.totalPersonnel,
        normal_student_count: appState.normalStudentCount,
        disabled_student_count: appState.disabledStudentCount,
        inclusion_student_count: appState.inclusionStudentCount,
        chronic_student_count: appState.chronicStudentCount,
        total_students: appState.totalStudents,
        answers: appState.answers,
        photos: filteredPhotos,
        previous_deficiencies: appState.previousDeficiencies,
        other_deficiencies: appState.otherDeficiencies,
        status: 'completed',
        created_at: new Date().toISOString()
      };
      appState.allAudits.push(newAudit);
    }

    // LocalStorage'a kaydet
    saveAuditsToStorage();
    
    // Google Sheets'e otomatik gÃ¶nder
    saveBtn.textContent = 'â³ Google Sheets\'e gÃ¶nderiliyor...';
    await sendToGoogleSheets(newAudit);

    renderAuditHistory();
    
    saveBtn.disabled = false;
    saveBtn.textContent = 'ğŸ’¾ Denetimi Kaydet';

    showToast('âœ“ Denetim kaydedildi ve Google Sheets\'e gÃ¶nderildi!');
    appState.editingAuditId = null;
    clearTempAudit();
    
    setTimeout(() => {
      clearAllForm();
      showPage('home');
      switchTab('new');
    }, 2000);
  } catch (error) {
    console.error('KayÄ±t hatasÄ±:', error);
    saveBtn.disabled = false;
    saveBtn.textContent = 'âŒ KayÄ±t HatasÄ±';
    showToast('âŒ KayÄ±t sÄ±rasÄ±nda hata oluÅŸtu!');
  }
}

    function saveAudit() {
      const saveBtn = document.getElementById('save-audit');
      saveBtn.disabled = true;
      saveBtn.textContent = 'â³ Kaydediliyor...';

      try {
        const filteredPhotos = {};
        Object.keys(appState.photos).forEach(code => {
          if (appState.answers[code] && appState.answers[code].value === 'no') {
            filteredPhotos[code] = appState.photos[code];
          }
        });

        if (appState.editingAuditId) {
          const auditIndex = appState.allAudits.findIndex(a => a.id === appState.editingAuditId);
          if (auditIndex !== -1) {
            appState.allAudits[auditIndex] = {
              ...appState.allAudits[auditIndex],
              school_name: appState.schoolName,
              school_code: appState.schoolCode,
              school_district: appState.schoolDistrict,
              audit_date: appState.auditDate,
              school_address: appState.schoolAddress,
              school_scope: appState.schoolScope,
              school_hazard_class: appState.schoolHazardClass,
              school_phone: appState.schoolPhone,
              school_email: appState.schoolEmail,
              manager_count: appState.managerCount,
              teacher_count: appState.teacherCount,
              officer_count: appState.officerCount,
              servant_count: appState.servantCount,
              worker_count: appState.workerCount,
              typ_count: appState.typCount,
              paid_teacher_count: appState.paidTeacherCount,
              contract_count: appState.contractCount,
              master_instructor_count: appState.masterInstructorCount,
              disabled_count: appState.disabledCount,
              exconvict_count: appState.exconvictCount,
              chronic_count: appState.chronicCount,
              total_personnel: appState.totalPersonnel,
              normal_student_count: appState.normalStudentCount,
              disabled_student_count: appState.disabledStudentCount,
              inclusion_student_count: appState.inclusionStudentCount,
              chronic_student_count: appState.chronicStudentCount,
              total_students: appState.totalStudents,
              answers: appState.answers,
              photos: filteredPhotos,
              previous_deficiencies: appState.previousDeficiencies,
              other_deficiencies: appState.otherDeficiencies,
              status: 'completed'
            };
          }
        } else {
          const newAudit = {
            id: generateId(),
            school_name: appState.schoolName,
            school_code: appState.schoolCode,
            school_district: appState.schoolDistrict,
            audit_date: appState.auditDate,
            school_address: appState.schoolAddress,
            school_scope: appState.schoolScope,
            school_hazard_class: appState.schoolHazardClass,
            school_phone: appState.schoolPhone,
            school_email: appState.schoolEmail,
            manager_count: appState.managerCount,
            teacher_count: appState.teacherCount,
            officer_count: appState.officerCount,
            servant_count: appState.servantCount,
            worker_count: appState.workerCount,
            typ_count: appState.typCount,
            paid_teacher_count: appState.paidTeacherCount,
            contract_count: appState.contractCount,
            master_instructor_count: appState.masterInstructorCount,
            disabled_count: appState.disabledCount,
            exconvict_count: appState.exconvictCount,
            chronic_count: appState.chronicCount,
            total_personnel: appState.totalPersonnel,
            normal_student_count: appState.normalStudentCount,
            disabled_student_count: appState.disabledStudentCount,
            inclusion_student_count: appState.inclusionStudentCount,
            chronic_student_count: appState.chronicStudentCount,
            total_students: appState.totalStudents,
            answers: appState.answers,
            photos: filteredPhotos,
            previous_deficiencies: appState.previousDeficiencies,
            other_deficiencies: appState.otherDeficiencies,
            status: 'completed',
            created_at: new Date().toISOString()
          };
          appState.allAudits.push(newAudit);
        }

        saveAuditsToStorage();
        renderAuditHistory();

        saveBtn.disabled = false;
        saveBtn.textContent = 'ğŸ’¾ Denetimi Kaydet';

        showToast('Denetim baÅŸarÄ±yla kaydedildi âœ“');
        appState.editingAuditId = null;
        clearTempAudit();
        setTimeout(() => {
          clearAllForm();
          showPage('home');
          switchTab('data');
        }, 1500);
      } catch (error) {
        console.error('Kaydetme hatasi:', error);
        showToast('Kaydetme hatasi: ' + error.message);
        saveBtn.disabled = false;
        saveBtn.textContent = 'ğŸ’¾ Denetimi Kaydet';
      }
    }

    // PDF Ä°ndir


async function downloadPDF() {
    const downloadBtn = document.getElementById('download-pdf');
    if (!downloadBtn) return;
    
    const originalText = downloadBtn.textContent;
    downloadBtn.disabled = true;
    downloadBtn.textContent = 'â³ PDF HazÄ±rlanÄ±yor...';

    try {
        const jspdf = window.jspdf;
        if (!jspdf) throw new Error("jsPDF kÃ¼tÃ¼phanesi bulunamadÄ±!");
        
        const { jsPDF } = jspdf;
        const doc = new jsPDF();

        // --- YARDIMCI FONKSÄ°YONLAR ---
        const formatDate = (dateStr) => {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            if (isNaN(date.getTime())) return dateStr;
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        };

        // --- 1. TÃœRKÃ‡E FONT YÃœKLEME ---
        const fontUrl = "https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf";
        const response = await fetch(fontUrl);
        const fontBlob = await response.blob();
        const reader = new FileReader();
        const fontBase64 = await new Promise((resolve) => {
            reader.onloadend = () => resolve(reader.result.split(',')[1]);
            reader.readAsDataURL(fontBlob);
        });

        doc.addFileToVFS("Roboto-Regular.ttf", fontBase64);
        doc.addFont("Roboto-Regular.ttf", "Roboto", "normal");
        doc.setFont("Roboto");

        // --- AYARLAR ---
        const greenFill = [22, 163, 74]; 
        const redFill = [185, 28, 28];
        const rowHeight = 6; 

        // --- GÃœNCELLENMÄ°Å SÃœTUN GENÄ°ÅLÄ°KLERÄ° ---
        const colStylesDenetim = {
            0: { cellWidth: 10, halign: 'center' }, // Soru Kodu (10 mm yapÄ±ldÄ±)
            1: { cellWidth: 102 },                  // Soru Metni (Koddan artan 5mm buraya eklendi)
            2: { cellWidth: 15, halign: 'center' }, // EVET
            3: { cellWidth: 15, halign: 'center' }, // HAYIR
            4: { cellWidth: 40 }                    // AÃ‡IKLAMA (Sabit 40 mm)
        };

        // --- 2. ÃœST BÄ°LGÄ° (HEADER) ---
        const drawHeader = (data) => {
            const ilceAdi = (appState.schoolDistrict || "..........").toUpperCase();
            doc.autoTable({
                startY: 10,
                tableWidth: 182,
                margin: { left: 14 },
                theme: 'grid',
                styles: { font: "Roboto", fontSize: 7, cellPadding: 1, valign: 'middle', textColor: [0, 0, 0], lineWidth: 0.2 },
                body: [
                    [
                        { content: 'Ä°ÅYERÄ° SAÄLIK VE\nGÃœVENLÄ°K BÄ°RÄ°MÄ°', rowSpan: 5, styles: { cellWidth: 30, fontStyle: 'bold', fontSize: 6, valign: 'bottom', halign: 'center', minCellHeight: 25 } },
                        { content: `ANKARA Ä°L MÄ°LLÄ° EÄÄ°TÄ°M MÃœDÃœRLÃœÄÃœ\n${ilceAdi} Ä°LÃ‡E MÄ°LLÄ° EÄÄ°TÄ°M MÃœDÃœRLÃœÄÃœ\nOKUL/KURUM Ä°SG REHBERLÄ°K, Ã‡ALIÅMA ORTAMI GÃ–ZETÄ°M VE DENETLEME FORMU`, rowSpan: 5, styles: { cellWidth: 92, fontSize: 8, fontStyle: 'bold', halign: 'center' } },
                        { content: ' DokÃ¼man No', styles: { cellWidth: 28, halign: 'left' } },
                        { content: 'FRM.014', styles: { cellWidth: 32, halign: 'center' } }
                    ],
                    [{ content: ' Ä°lk YayÄ±n Tarihi', styles: { halign: 'left' } }, { content: '30.10.2023', styles: { halign: 'center' } }],
                    [{ content: ' Revizyon Tarihi', styles: { halign: 'left' } }, { content: '../../20..', styles: { halign: 'center' } }],
                    [{ content: ' Revizyon No', styles: { halign: 'left' } }, { content: '0', styles: { halign: 'center' } }],
                    [{ content: ' Sayfa No', styles: { halign: 'left' } }, { content: '' }] 
                ],
            });
            data.settings.margin.top = 38; 
        };

        const formattedAuditDate = formatDate(appState.auditDate);

        // --- 3. TABLOLAR ---

        // Okul Bilgileri
        doc.autoTable({
            startY: 38, 
            head: [[
                { content: 'OKUL/KURUM BÄ°LGÄ°LERÄ°', colSpan: 2, styles: { halign: 'left', valign: 'middle' } }, 
                { content: `TARÄ°H: ${formattedAuditDate}`, colSpan: 2, styles: { halign: 'right', valign: 'middle', cellPadding: { right: 20 } } } 
            ]],
            body: [
                ['AdÄ±', appState.schoolName || '', 'Tehlike SÄ±nÄ±fÄ±', appState.schoolHazardClass || ''],
                ['Kodu', appState.schoolCode || '', 'Ä°ÅŸyeri Sicil No', appState.schoolRegistrationNumber || ''],
                ['Adresi', appState.schoolAddress || '', 'Telefon', appState.schoolPhone || ''],
                ['Kapsam', appState.schoolScope || '', 'E-Posta', appState.schoolEmail || '']
            ],
            theme: 'grid',
            styles: { font: "Roboto", fontSize: 8, cellPadding: 1.2, valign: 'middle', minCellHeight: rowHeight },
            headStyles: { fillColor: greenFill, textColor: [255, 255, 255], fontStyle: 'bold' },
            columnStyles: { 0: { cellWidth: 15, fontStyle: 'bold' }, 1: { cellWidth: 70 }, 2: { cellWidth: 31, fontStyle: 'bold' }, 3: { cellWidth: 66 } },
            didDrawPage: drawHeader
        });

        // Personel Bilgileri
        doc.autoTable({
            startY: doc.lastAutoTable.finalY + 3,
            head: [['PERSONEL TÃœRÃœ', 'Normal', 'Engelli', 'Eski HÃ¼kÃ¼mlÃ¼', 'Kronik']],
            body: [
                ['YÃ¶netici SayÄ±sÄ±', appState.managerCount || '0', '', '', ''],
                ['Ã–ÄŸretmen SayÄ±sÄ±', appState.teacherCount || '0', '', '', ''],
                ['Ã–ÄŸrenci SayÄ±sÄ±', appState.totalStudents || '0', appState.disabledStudentCount || '0', '', '']
            ],
            theme: 'grid',
            styles: { font: "Roboto", fontSize: 8, valign: 'middle', minCellHeight: rowHeight, cellPadding: 1.2 },
            headStyles: { fillColor: greenFill },
            didDrawPage: drawHeader
        });

        // Denetim Maddeleri (Kod: 10mm, AÃ§Ä±klama: 40mm)
        let currentY = doc.lastAutoTable.finalY + 3;
        let deficiencies = []; 
        if (typeof categoryOrder !== 'undefined' && typeof auditQuestions !== 'undefined') {
            for (const catKey of categoryOrder) {
                const category = auditQuestions[catKey];
                const rows = category.questions.map(q => {
                    const ans = appState.answers[q.code] || { value: '', note: '', dof: '' };
                    if (ans.value === 'no') deficiencies.push(`${ans.dof || 'Belirtilmedi'} (${q.code})`);
                    return [q.code, q.text, ans.value === 'yes' ? 'X' : '', ans.value === 'no' ? 'X' : '', ans.note || ''];
                });
                doc.autoTable({
                    startY: currentY,
                    head: [[catKey, category.title, 'EVET', 'HAYIR', 'AÃ‡IKLAMA']],
                    body: rows,
                    theme: 'grid',
                    styles: { font: "Roboto", fontSize: 7, valign: 'middle', minCellHeight: rowHeight, cellPadding: 1.2 },
                    headStyles: { fillColor: greenFill },
                    columnStyles: colStylesDenetim, 
                    pageBreak: 'auto',
                    didDrawPage: drawHeader
                });
                currentY = doc.lastAutoTable.finalY + 3;
            }
        }

        // GÃ¶zlemler (KÄ±rmÄ±zÄ± BÃ¶lÃ¼m)
        let finalDofRows = deficiencies.map((dofText, index) => [(index + 1).toString(), dofText]);
        if (appState.otherDeficiencies && appState.otherDeficiencies.length > 0) {
            appState.otherDeficiencies.forEach((other, i) => finalDofRows.push([(deficiencies.length + i + 1).toString(), other]));
        }

        doc.autoTable({
            startY: currentY + 3,
            head: [[{ content: 'OKUL/KURUMDA GÃ–ZLEMLER, EKSÄ°KLÄ°KLER, TESPÄ°T, Ã–NERÄ°LER VE DEÄERLENDÄ°RMELER', colSpan: 2 }]],
            body: finalDofRows.length > 0 ? finalDofRows : [['-', 'YapÄ±lan denetimde herhangi bir uygunsuzluk tespit edilmemiÅŸtir.']],
            theme: 'grid',
            styles: { font: "Roboto", fontSize: 8, cellPadding: 1.2, valign: 'middle', minCellHeight: rowHeight },
            headStyles: { fillColor: redFill, halign: 'center', fontStyle: 'bold' },
            columnStyles: { 0: { cellWidth: 10, halign: 'center' } }, // GÃ¶zlem numarasÄ± kod sÃ¼tunuyla aynÄ± geniÅŸlikte
            didDrawPage: drawHeader
        });

        // Onay BÃ¶lÃ¼mÃ¼
        doc.autoTable({
            startY: doc.lastAutoTable.finalY + 5,
            head: [[{content: 'ONAY', styles:{halign:'center'}}, {content: 'OKUL / KURUM', colSpan:2, styles:{halign:'center'}}, {content: 'Ä°LÃ‡E MÄ°LLÄ° EÄÄ°TÄ°M MÃœDÃœRLÃœÄÃœ', colSpan:2, styles:{halign:'center'}}]],
            body: [
                ['UNVANI', 'MÃ¼dÃ¼r Yard.', 'Okul MÃ¼dÃ¼rÃ¼', 'Ä°SG BÃ¼ro YÃ¶n.', 'Åube MÃ¼dÃ¼rÃ¼'],
                ['Ä°MZA', '', '', '', ''],
                ['ADI SOYADI', appState.vicarName || '', appState.principalName || '', appState.inspectorName || '', appState.subManagerName || ''],
                ['CEP TEL', '', '', '', '']
            ],
            theme: 'grid',
            styles: { font: "Roboto", fontSize: 7, halign: 'center', valign: 'middle', minCellHeight: rowHeight, cellPadding: 1.2 },
            headStyles: { fillColor: greenFill },
            didDrawPage: drawHeader
        });

        // --- 4. SAYFA NUMARALANDIRMA ---
        const totalPages = doc.internal.getNumberOfPages();
        for (let i = 1; i <= totalPages; i++) {
            doc.setPage(i);
            doc.setFontSize(7);
            doc.setTextColor(0, 0, 0);
            doc.text(`${i} / ${totalPages}`, 180, 33.0, { align: 'center' }); 
        }

        doc.save(`ISG_Denetim_Raporu_${appState.schoolCode || 'Rapor'}.pdf`);
        if (typeof showToast !== 'undefined') showToast('Rapor BaÅŸarÄ±yla HazÄ±rlandÄ±! âœ“');

    } catch (error) {
        console.error('PDF HatasÄ±:', error);
        alert('Hata: ' + error.message);
    } finally {
        downloadBtn.disabled = false;
        downloadBtn.textContent = originalText;
    }
}









    // Event Listeners
    document.getElementById('school-code').addEventListener('input', checkPreviousAudits);
    document.getElementById('school-name').addEventListener('input', checkPreviousAudits);
    
    document.getElementById('start-audit-btn').addEventListener('click', () => {
      const schoolCode = document.getElementById('school-code').value.trim();
      const schoolName = document.getElementById('school-name').value.trim();
      const schoolDistrict = document.getElementById('school-district').value.trim();
      const auditDate = document.getElementById('audit-date').value;
      const schoolAddress = document.getElementById('school-address').value.trim();
      const schoolScope = document.getElementById('school-scope').value.trim();
      const schoolHazardClass = document.getElementById('school-hazard-class').value;
      const schoolPhone = document.getElementById('school-phone').value.trim();
      const schoolEmail = document.getElementById('school-email').value.trim();
      
      if (!schoolCode || !schoolName || !schoolDistrict || !auditDate) {
        showToast('LÃ¼tfen zorunlu alanlarÄ± doldurun');
        return;
      }
      
      appState.schoolCode = schoolCode;
      appState.schoolName = schoolName;
      appState.schoolDistrict = schoolDistrict;
      appState.auditDate = auditDate;
      appState.schoolAddress = schoolAddress;
      appState.schoolScope = schoolScope;
      appState.schoolHazardClass = schoolHazardClass;
      appState.schoolPhone = schoolPhone;
      appState.schoolEmail = schoolEmail;
      
      document.getElementById('personnel-school-info').textContent = 
        `${appState.schoolName} â€¢ ${appState.schoolDistrict} â€¢ ${appState.auditDate}`;
      
      document.getElementById('manager-count').value = appState.managerCount || 0;
      document.getElementById('teacher-count').value = appState.teacherCount || 0;
      document.getElementById('officer-count').value = appState.officerCount || 0;
      document.getElementById('servant-count').value = appState.servantCount || 0;
      document.getElementById('worker-count').value = appState.workerCount || 0;
      document.getElementById('typ-count').value = appState.typCount || 0;
      document.getElementById('paid-teacher-count').value = appState.paidTeacherCount || 0;
      document.getElementById('contract-count').value = appState.contractCount || 0;
      document.getElementById('master-instructor-count').value = appState.masterInstructorCount || 0;
      document.getElementById('disabled-count').value = appState.disabledCount || 0;
      document.getElementById('exconvict-count').value = appState.exconvictCount || 0;
      document.getElementById('chronic-count').value = appState.chronicCount || 0;
      calculateTotalPersonnel();

      document.getElementById('normal-student-count').value = appState.normalStudentCount || 0;
      document.getElementById('disabled-student-count').value = appState.disabledStudentCount || 0;
      document.getElementById('inclusion-student-count').value = appState.inclusionStudentCount || 0;
      document.getElementById('chronic-student-count').value = appState.chronicStudentCount || 0;
      calculateTotalStudents();
      
      saveTempAudit();
      showPage('personnel');
    });

    document.getElementById('back-to-home').addEventListener('click', () => {
      appState.managerCount = parseInt(document.getElementById('manager-count').value) || 0;
      appState.teacherCount = parseInt(document.getElementById('teacher-count').value) || 0;
      appState.officerCount = parseInt(document.getElementById('officer-count').value) || 0;
      appState.servantCount = parseInt(document.getElementById('servant-count').value) || 0;
      appState.workerCount = parseInt(document.getElementById('worker-count').value) || 0;
      appState.typCount = parseInt(document.getElementById('typ-count').value) || 0;
      appState.paidTeacherCount = parseInt(document.getElementById('paid-teacher-count').value) || 0;
      appState.contractCount = parseInt(document.getElementById('contract-count').value) || 0;
      appState.masterInstructorCount = parseInt(document.getElementById('master-instructor-count').value) || 0;
      appState.disabledCount = parseInt(document.getElementById('disabled-count').value) || 0;
      appState.exconvictCount = parseInt(document.getElementById('exconvict-count').value) || 0;
      appState.chronicCount = parseInt(document.getElementById('chronic-count').value) || 0;
      appState.totalPersonnel = parseInt(document.getElementById('total-personnel').value) || 0;
      
      appState.normalStudentCount = parseInt(document.getElementById('normal-student-count').value) || 0;
      appState.disabledStudentCount = parseInt(document.getElementById('disabled-student-count').value) || 0;
      appState.inclusionStudentCount = parseInt(document.getElementById('inclusion-student-count').value) || 0;
      appState.chronicStudentCount = parseInt(document.getElementById('chronic-student-count').value) || 0;
      appState.totalStudents = parseInt(document.getElementById('total-students').value) || 0;
      
      saveTempAudit();
      showPage('home');
      switchTab('new');
    });

    document.getElementById('continue-to-audit').addEventListener('click', () => {
      appState.managerCount = parseInt(document.getElementById('manager-count').value) || 0;
      appState.teacherCount = parseInt(document.getElementById('teacher-count').value) || 0;
      appState.officerCount = parseInt(document.getElementById('officer-count').value) || 0;
      appState.servantCount = parseInt(document.getElementById('servant-count').value) || 0;
      appState.workerCount = parseInt(document.getElementById('worker-count').value) || 0;
      appState.typCount = parseInt(document.getElementById('typ-count').value) || 0;
      appState.paidTeacherCount = parseInt(document.getElementById('paid-teacher-count').value) || 0;
      appState.contractCount = parseInt(document.getElementById('contract-count').value) || 0;
      appState.masterInstructorCount = parseInt(document.getElementById('master-instructor-count').value) || 0;
      appState.disabledCount = parseInt(document.getElementById('disabled-count').value) || 0;
      appState.exconvictCount = parseInt(document.getElementById('exconvict-count').value) || 0;
      appState.chronicCount = parseInt(document.getElementById('chronic-count').value) || 0;
      appState.totalPersonnel = parseInt(document.getElementById('total-personnel').value) || 0;
      
      appState.normalStudentCount = parseInt(document.getElementById('normal-student-count').value) || 0;
      appState.disabledStudentCount = parseInt(document.getElementById('disabled-student-count').value) || 0;
      appState.inclusionStudentCount = parseInt(document.getElementById('inclusion-student-count').value) || 0;
      appState.chronicStudentCount = parseInt(document.getElementById('chronic-student-count').value) || 0;
      appState.totalStudents = parseInt(document.getElementById('total-students').value) || 0;
      
      const hasTemp = localStorage.getItem('isg_temp_audit');
      if (!hasTemp || Object.keys(appState.answers).length === 0) {
        appState.currentCategoryIndex = 0;
        appState.editingAuditId = null;
        appState.answers = {};
        appState.photos = {};
        
        if (appState.previousDeficiencies.length > 0) {
          appState.previousDeficiencies.forEach(def => {
            appState.answers[def.code] = {
              value: 'no',
              dof: def.dof,
              note: ''
            };
          });
        }
      }
      
      saveTempAudit();
      showPage('audit');
      renderCurrentCategory();
    });

    document.getElementById('prev-category').addEventListener('click', goToPrevCategory);
    document.getElementById('next-category').addEventListener('click', goToNextCategory);

    document.getElementById('back-to-audit').addEventListener('click', () => {
      showPage('audit');
    });

    document.getElementById('save-audit').addEventListener('click', saveAudit);
    document.getElementById('download-pdf').addEventListener('click', downloadPDF);

    document.getElementById('camera-input').addEventListener('change', (e) => handlePhotoSelect(e.target.files[0]));
    document.getElementById('gallery-input').addEventListener('change', (e) => handlePhotoSelect(e.target.files[0]));
    document.getElementById('cancel-photo').addEventListener('click', closePhotoModal);
    document.getElementById('save-photo').addEventListener('click', savePhotoFunc);

    document.getElementById('add-other-dof').addEventListener('click', addOtherDof);
    document.getElementById('other-dof-text').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        addOtherDof();
      }
    });

    // GeÃ§ici denetimi kaydet
    function saveTempAudit() {
      const tempAudit = {
        schoolCode: appState.schoolCode,
        schoolName: appState.schoolName,
        schoolDistrict: appState.schoolDistrict,
        auditDate: appState.auditDate,
        schoolAddress: appState.schoolAddress,
        schoolScope: appState.schoolScope,
        schoolHazardClass: appState.schoolHazardClass,
        schoolPhone: appState.schoolPhone,
        schoolEmail: appState.schoolEmail,
        managerCount: appState.managerCount,
        teacherCount: appState.teacherCount,
        officerCount: appState.officerCount,
        servantCount: appState.servantCount,
        workerCount: appState.workerCount,
        typCount: appState.typCount,
        paidTeacherCount: appState.paidTeacherCount,
        contractCount: appState.contractCount,
        masterInstructorCount: appState.masterInstructorCount,
        disabledCount: appState.disabledCount,
        exconvictCount: appState.exconvictCount,
        chronicCount: appState.chronicCount,
        totalPersonnel: appState.totalPersonnel,
        normalStudentCount: appState.normalStudentCount,
        disabledStudentCount: appState.disabledStudentCount,
        inclusionStudentCount: appState.inclusionStudentCount,
        chronicStudentCount: appState.chronicStudentCount,
        totalStudents: appState.totalStudents,
        currentCategoryIndex: appState.currentCategoryIndex,
        answers: appState.answers,
        photos: appState.photos,
        previousDeficiencies: appState.previousDeficiencies,
        otherDeficiencies: appState.otherDeficiencies
      };
      localStorage.setItem('isg_temp_audit', JSON.stringify(tempAudit));
    }

    // GeÃ§ici denetimi yÃ¼kle
    function loadTempAudit() {
      try {
        const saved = localStorage.getItem('isg_temp_audit');
        if (saved) {
          const temp = JSON.parse(saved);
          appState.schoolCode = temp.schoolCode || '';
          appState.schoolName = temp.schoolName || '';
          appState.schoolDistrict = temp.schoolDistrict || '';
          appState.auditDate = temp.auditDate || '';
          appState.schoolAddress = temp.schoolAddress || '';
          appState.schoolScope = temp.schoolScope || '';
          appState.schoolHazardClass = temp.schoolHazardClass || '';
          appState.schoolPhone = temp.schoolPhone || '';
          appState.schoolEmail = temp.schoolEmail || '';
          appState.managerCount = temp.managerCount || 0;
          appState.teacherCount = temp.teacherCount || 0;
          appState.officerCount = temp.officerCount || 0;
          appState.servantCount = temp.servantCount || 0;
          appState.workerCount = temp.workerCount || 0;
          appState.typCount = temp.typCount || 0;
          appState.paidTeacherCount = temp.paidTeacherCount || 0;
          appState.contractCount = temp.contractCount || 0;
          appState.masterInstructorCount = temp.masterInstructorCount || 0;
          appState.disabledCount = temp.disabledCount || 0;
          appState.exconvictCount = temp.exconvictCount || 0;
          appState.chronicCount = temp.chronicCount || 0;
          appState.totalPersonnel = temp.totalPersonnel || 0;
          appState.normalStudentCount = temp.normalStudentCount || 0;
          appState.disabledStudentCount = temp.disabledStudentCount || 0;
          appState.inclusionStudentCount = temp.inclusionStudentCount || 0;
          appState.chronicStudentCount = temp.chronicStudentCount || 0;
          appState.totalStudents = temp.totalStudents || 0;
          appState.currentCategoryIndex = temp.currentCategoryIndex || 0;
          appState.answers = temp.answers || {};
          appState.photos = temp.photos || {};
          appState.previousDeficiencies = temp.previousDeficiencies || [];
          appState.otherDeficiencies = temp.otherDeficiencies || [];
        }
      } catch (e) {
        console.error('Gecici denetim yuklenemedi:', e);
      }
    }

    // GeÃ§ici denetimi temizle
    function clearTempAudit() {
      localStorage.removeItem('isg_temp_audit');
    }

    // Sayfa yÃ¼klendiÄŸinde
    document.addEventListener('DOMContentLoaded', () => {
      loadAuditsFromStorage();
      loadTempAudit();
      
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('audit-date').value = today;
    });


async function submitAudit() {
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbysE9xtt1y_BelfH0yl_GI3-XuZ8HmS7Y9JfPTe0nVfPZIAuv9ZeIMMF_C0PJ52qvZO/exec";
    const btn = document.getElementById('save-audit');
    const originalText = btn.innerText;

    // 1. Verileri senin orijinal yapÄ±ndan topla
   const finalData = {
    // ... diÄŸer bilgiler ...
    questions: Object.keys(answers).map(key => ({
        id: key,
        status: answers[key]
    }))
};

    // TÃ¼m radyo butonlarÄ±ndaki cevaplarÄ± topla
    document.querySelectorAll('input[type="radio"]:checked').forEach(radio => {
        finalData.questions.push({
            id: radio.name,
            status: radio.value
        });
    });

    if(!finalData.schoolName) {
        alert("LÃ¼tfen okul adÄ±nÄ± doldurun!");
        return;
    }

    btn.innerText = "â³ Kaydediliyor...";
    btn.disabled = true;

    // 2. Google Script'e GÃ–NDER (GitHub uyumlu yÃ¶ntem)
    try {
        await fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(finalData)
        });
        
        alert("âœ… BaÅŸarÄ±yla kaydedildi!");
        btn.innerText = originalText;
        btn.disabled = false;
        
        // Formu temizle (senin orijinal fonksiyonun varsa Ã§alÄ±ÅŸÄ±r)
        if(typeof clearTempAudit === 'function') clearTempAudit();
        location.reload(); 
        
    } catch (err) {
        alert("Hata oluÅŸtu: " + err);
        btn.innerText = originalText;
        btn.disabled = false;
    }
}

  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c79b84c11c6d5ff',t:'MTc3MDAzNTYzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>



